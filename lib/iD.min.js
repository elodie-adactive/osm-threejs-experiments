/**
 * Created by elodie on 07/10/15.
 */
function sha1(){function e(e){return v(u(p(e),e.length*b))}function t(e){return m(u(p(e),e.length*b))}function n(e){return d(u(p(e),e.length*b))}function r(e,t){return v(l(e,t))}function i(e,t){return m(l(e,t))}function s(e,t){return d(l(e,t))}function o(){return e("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function u(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;var n=Array(80),r=1732584193,i=-271733879,s=-1732584194,o=271733878,u=-1009589776;for(var l=0;l<e.length;l+=16){var p=r,d=i,v=s,m=o,g=u;for(var y=0;y<80;y++){y<16?n[y]=e[l+y]:n[y]=h(n[y-3]^n[y-8]^n[y-14]^n[y-16],1);var b=c(c(h(r,5),a(y,i,s,o)),c(c(u,n[y]),f(y)));u=o,o=s,s=h(i,30),i=r,r=b}r=c(r,p),i=c(i,d),s=c(s,v),o=c(o,m),u=c(u,g)}return Array(r,i,s,o,u)}function a(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function f(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function l(e,t){var n=p(e);n.length>16&&(n=u(n,e.length*b));var r=Array(16),i=Array(16);for(var s=0;s<16;s++)r[s]=n[s]^909522486,i[s]=n[s]^1549556828;var o=u(r.concat(p(t)),512+t.length*b);return u(i.concat(o),672)}function c(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function h(e,t){return e<<t|e>>>32-t}function p(e){var t=Array(),n=(1<<b)-1;for(var r=0;r<e.length*b;r+=b)t[r>>5]|=(e.charCodeAt(r/b)&n)<<32-b-r%32;return t}function d(e){var t="",n=(1<<b)-1;for(var r=0;r<e.length*32;r+=b)t+=String.fromCharCode(e[r>>5]>>>32-b-r%32&n);return t}function v(e){var t=g?"0123456789ABCDEF":"0123456789abcdef",n="";for(var r=0;r<e.length*4;r++)n+=t.charAt(e[r>>2]>>(3-r%4)*8+4&15)+t.charAt(e[r>>2]>>(3-r%4)*8&15);return n}function m(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="";for(var r=0;r<e.length*4;r+=3){var i=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255;for(var s=0;s<4;s++)r*8+s*6>e.length*32?n+=y:n+=t.charAt(i>>6*(3-s)&63)}return n}var g=0,y="=",b=8;return{b64_hmac_sha1:i}}(function(){function e(){return 0}function t(e){return e.target}function n(e){return e.source}function r(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function i(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function s(e){return Array.prototype.slice.call(e)}function o(){}function u(e){return e}function a(){return!0}function f(e){return typeof e=="function"?e:function(){return e}}function l(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function c(e){return e!=null&&!isNaN(e)}function h(e){return e.length}function p(e){return e.trim().replace(/\s+/g," ")}function d(e){var t=1;while(e*t%1)t*=10;return t}function v(e){return e.responseText}function m(e){return JSON.parse(e.responseText)}function g(e){var t=document.createRange();return t.selectNode(document.body),t.createContextualFragment(e.responseText)}function y(e){return e.responseXML}function b(){}function w(e){function t(){var t=n,r=-1,i=t.length,s;while(++r<i)(s=t[r].on)&&s.apply(this,arguments);return e}var n=[],r=new o;return t.on=function(t,i){var s=r.get(t),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),r.remove(t)),i&&n.push(r.set(t,{on:i})),e)},t}function E(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function S(e){return e+""}function x(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function T(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function N(e){return function(t){return 1-e(1-t)}}function C(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function k(e){return e*e}function L(e){return e*e*e}function A(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function O(e){return function(t){return Math.pow(t,e)}}function M(e){return 1-Math.cos(e*xs/2)}function _(e){return Math.pow(2,10*(e-1))}function D(e){return 1-Math.sqrt(1-e*e)}function P(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/(2*xs)*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*xs/t)}}function H(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function B(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function j(){d3.event.stopPropagation(),d3.event.preventDefault()}function F(){var e=d3.event,t;while(t=e.sourceEvent)e=t;return e}function I(e){var t=new b,n=0,r=arguments.length;while(++n<r)t[arguments[n]]=w(t);return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(n,r)}finally{d3.event=s}}},t}function q(e){var t=[e.a,e.b],n=[e.c,e.d],r=U(t),i=R(t,n),s=U(z(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*ks,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*ks:0}function R(e,t){return e[0]*t[0]+e[1]*t[1]}function U(e){var t=Math.sqrt(R(e,e));return t&&(e[0]/=t,e[1]/=t),t}function z(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function W(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function X(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function V(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function $(){}function J(e,t,n){return new K(e,t,n)}function K(e,t,n){this.r=e,this.g=t,this.b=n}function Q(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function G(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(tt(u[0]),tt(u[1]),tt(u[2]))}}return(a=$s.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function Y(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,nt(o,u,a)}function Z(e,t,n){e=et(e),t=et(t),n=et(n);var r=pt((.4124564*e+.3575761*t+.1804375*n)/Gs),i=pt((.2126729*e+.7151522*t+.072175*n)/Ys),s=pt((.0193339*e+.119192*t+.9503041*n)/Zs);return at(116*i-16,500*(r-i),200*(i-s))}function et(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function tt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function nt(e,t,n){return new rt(e,t,n)}function rt(e,t,n){this.h=e,this.s=t,this.l=n}function it(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o,J(i(e+120),i(e),i(e-120))}function st(e,t,n){return new ot(e,t,n)}function ot(e,t,n){this.h=e,this.c=t,this.l=n}function ut(e,t,n){return at(n,Math.cos(e*=Cs)*t,Math.sin(e)*t)}function at(e,t,n){return new ft(e,t,n)}function ft(e,t,n){this.l=e,this.a=t,this.b=n}function lt(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=ht(i)*Gs,r=ht(r)*Ys,s=ht(s)*Zs,J(dt(3.2404542*i-1.5371385*r-.4985314*s),dt(-0.969266*i+1.8760108*r+.041556*s),dt(.0556434*i-.2040259*r+1.0572252*s))}function ct(e,t,n){return st(Math.atan2(n,t)/xs*180,Math.sqrt(t*t+n*n),e)}function ht(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function pt(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function dt(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function vt(e){return Os(e,oo),e}function mt(e){return function(){return to(e,this)}}function gt(e){return function(){return no(e,this)}}function yt(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i}function bt(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function wt(e,t){function n(){var n=-1;while(++n<i)e[n](this,t)}function r(){var n=-1,r=t.apply(this,arguments);while(++n<i)e[n](this,r)}e=e.trim().split(/\s+/).map(Et);var i=e.length;return typeof t=="function"?r:n}function Et(e){var t=bt(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=p(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=p(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function St(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function xt(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function Tt(e){return{__data__:e}}function Nt(e){return function(){return so(this,e)}}function Ct(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function kt(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function i(){function i(e){var n=d3.event;d3.event=e,u[0]=o.__data__;try{t.apply(o,u)}finally{d3.event=n}}var o=this,u=Ls(arguments);r.call(this),this.addEventListener(e,this[s]=i,i.$=n),i._=t}var s="__on"+e,o=e.indexOf(".");return o>0&&(e=e.substring(0,o)),t?i:r}function Lt(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function At(e){return Os(e,ao),e}function Ot(e,t){return Os(e,fo),e.id=t,e}function Mt(e,t,n,r){var i=e.__transition__||(e.__transition__={active:0,count:0}),s=i[n];if(!s){var u=r.time;return s=i[n]={tween:new o,event:d3.dispatch("start","end"),time:u,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,d3.timer(function(r){function o(r){return i.active>n?f():(i.active=n,h.start.call(e,l,t),s.tween.forEach(function(n,r){(r=r.call(e,l,t))&&v.push(r)}),a(r)||d3.timer(a,0,u),1)}function a(r){if(i.active!==n)return f();var s=(r-p)/d,o=c(s),u=v.length;while(u>0)v[--u].call(e,o);if(s>=1)return f(),h.end.call(e,l,t),1}function f(){return--i.count?delete i[n]:delete e.__transition__,1}var l=e.__data__,c=s.ease,h=s.event,p=s.delay,d=s.duration,v=[];return p<=r?o(r):d3.timer(o,p,u),1},0,u),s}}function _t(e){return e==null&&(e=""),function(){this.textContent=e}}function Dt(e,t,n,r){var i=e.id;return Lt(e,typeof n=="function"?function(e,s,o){e.__transition__[i].tween.set(t,r(n.call(e,e.__data__,s,o)))}:(n=r(n),function(e){e.__transition__[i].tween.set(t,n)}))}function Pt(){var e,t=Date.now(),n=mo;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=Ht()-t;r>24?(isFinite(r)&&(clearTimeout(yo),yo=setTimeout(Pt,r)),go=0):(go=1,bo(Pt))}function Ht(){var e=null,t=mo,n=Infinity;while(t)t.flush?(delete vo[t.callback.id],t=e?e.next=t.next:mo=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Bt(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(wo<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=n[0][0].getScreenCTM();wo=!i.f&&!i.e,n.remove()}return wo?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function jt(){}function Ft(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function It(e){return e.rangeExtent?e.rangeExtent():Ft(e.range())}function qt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function Rt(){return Math}function Ut(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?Kt:Jt,a=r?V:X;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return Vt(e,t)},s.tickFormat=function(t){return $t(e,t)},s.nice=function(){return qt(e,Wt),i()},s.copy=function(){return Ut(e,t,n,r)},i()}function zt(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Wt(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Xt(e,t){var n=Ft(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function Vt(e,t){return d3.range.apply(d3,Xt(e,t))}function $t(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Xt(e,t)[2])/Math.LN10+.01))+"f")}function Jt(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function Kt(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++o<=u)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=d3.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function Qt(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?Yt:Gt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(qt(e.domain(),Rt)),n},n.ticks=function(){var n=Ft(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=r(n[0]),a=r(n[1]);if(t===Yt){i.push(r(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(r(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(r(s)*f);i.push(r(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=Eo);if(!arguments.length)return i;var s=Math.max(.1,e/n.ticks().length),o=t===Yt?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<=s?i(e):""}},n.copy=function(){return Qt(e.copy(),t)},zt(n,e)}function Gt(e){return Math.log(e<0?0:e)/Math.LN10}function Yt(e){return-Math.log(e>0?0:-e)/Math.LN10}function Zt(e,t){function n(t){return e(r(t))}var r=en(t),i=en(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return Vt(n.domain(),e)},n.tickFormat=function(e){return $t(n.domain(),e)},n.nice=function(){return n.domain(qt(n.domain(),Wt))},n.exponent=function(e){if(!arguments.length)return t;var s=n.domain();return r=en(t=e),i=en(1/t),n.domain(s)},n.copy=function(){return Zt(e.copy(),t)},zt(n,e)}function en(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tn(e,t){function n(t){return s[((i.get(t)||i.set(t,e.push(t)))-1)%s.length]}function r(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var i,s,u;return n.domain=function(r){if(!arguments.length)return e;e=[],i=new o;var s=-1,u=r.length,a;while(++s<u)i.has(a=r[s])||i.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(s=e,u=0,t={t:"range",a:arguments},n):s},n.rangePoints=function(i,o){arguments.length<2&&(o=0);var a=i[0],f=i[1],l=(f-a)/(Math.max(1,e.length-1)+o);return s=r(e.length<2?(a+f)/2:a+l*o/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,o,a){arguments.length<2&&(o=0),arguments.length<3&&(a=o);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=(c-l)/(e.length-o+2*a);return s=r(l+h*a,h),f&&s.reverse(),u=h*(1-o),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,o,a){arguments.length<2&&(o=0),arguments.length<3&&(a=o);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=Math.floor((c-l)/(e.length-o+2*a)),p=c-l-(e.length-o)*h;return s=r(l+Math.round(p/2),h),f&&s.reverse(),u=Math.round(h*(1-o)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return Ft(t.a[0])},n.copy=function(){return tn(e,t)},n.domain(e)}function nn(e,t){function n(){var n=0,s=t.length;i=[];while(++n<s)i[n-1]=d3.quantile(e,n/s);return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return nn(e,t)},n()}function rn(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return rn(e,t,n)},i()}function sn(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return sn(e,t)},n}function on(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Vt(e,t)},t.tickFormat=function(t){return $t(e,t)},t.copy=function(){return on(e)},t}function un(e){return e.innerRadius}function an(e){return e.outerRadius}function fn(e){return e.startAngle}function ln(e){return e.endAngle}function cn(e){function t(t){function o(){a.push("M",s(e(l),u))}var a=[],l=[],c=-1,h=t.length,p,d=f(n),v=f(r);while(++c<h)i.call(this,p=t[c],c)?l.push([+d.call(this,p,c),+v.call(this,p,c)]):l.length&&(o(),l=[]);return l.length&&o(),a.length?a.join(""):null}var n=hn,r=pn,i=a,s=dn,o=s.key,u=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(typeof e=="function"?o=s=e:o=(s=Lo.get(e)||dn).key,t):o},t.tension=function(e){return arguments.length?(u=e,t):u},t}function hn(e){return e[0]}function pn(e){return e[1]}function dn(e){return e.join("L")}function vn(e){return dn(e)+"Z"}function mn(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function gn(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function yn(e,t){return e.length<4?dn(e):e[1]+En(e.slice(1,e.length-1),Sn(e,t))}function bn(e,t){return e.length<3?dn(e):e[0]+En((e.push(e[0]),e),Sn([e[e.length-2]].concat(e,[e[1]]),t))}function wn(e,t){return e.length<3?dn(e):e[0]+En(e,Sn(e,t))}function En(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return dn(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function Sn(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function xn(e){if(e.length<3)return dn(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Ln(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Ln(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Ln(a,o,u);return a.join("")}function Tn(e){if(e.length<4)return dn(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(kn(Mo,s)+","+kn(Mo,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Ln(t,s,o);return t.join("")}function Nn(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[kn(Mo,o),",",kn(Mo,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Ln(t,o,u);return t.join("")}function Cn(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}return xn(e)}function kn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ln(e,t,n){e.push("C",kn(Ao,t),",",kn(Ao,n),",",kn(Oo,t),",",kn(Oo,n),",",kn(Mo,t),",",kn(Mo,n))}function An(e,t){return(t[1]-e[1])/(t[0]-e[0])}function On(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=An(i,s);while(++t<n)r[t]=(o+(o=An(i=s,s=e[t+1])))/2;return r[t]=o,r}function Mn(e){var t=[],n,r,i,s,o=On(e),u=-1,a=e.length-1;while(++u<a)n=An(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function _n(e){return e.length<3?dn(e):e[0]+En(e,Mn(e))}function Dn(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+Co,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function Pn(e){function t(t){function a(){l.push("M",u(e(v),p),h,c(e(d.reverse()),p),"Z")}var l=[],d=[],v=[],m=-1,g=t.length,y,b=f(n),w=f(i),E=n===r?function(){return x}:f(r),S=i===s?function(){return T}:f(s),x,T;while(++m<g)o.call(this,y=t[m],m)?(d.push([x=+b.call(this,y,m),T=+w.call(this,y,m)]),v.push([+E.call(this,y,m),+S.call(this,y,m)])):d.length&&(a(),d=[],v=[]);return d.length&&a(),l.length?l.join(""):null}var n=hn,r=hn,i=0,s=pn,o=a,u=dn,l=u.key,c=u,h="L",p=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(typeof e=="function"?l=u=e:l=(u=Lo.get(e)||dn).key,c=u.reverse||u,h=u.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(p=e,t):p},t}function Hn(e){return e.radius}function Bn(e){return[e.x,e.y]}function jn(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Co;return[n*Math.cos(r),n*Math.sin(r)]}}function Fn(){return 64}function In(){return"circle"}function qn(e){var t=Math.sqrt(e/xs);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Rn(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function Un(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function zn(e,t,n){i=[];if(n&&t.length>1){var r=Ft(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function Wn(){jo||(jo=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e=d3.event,t;try{jo.scrollTop=1e3,jo.dispatchEvent(e),t=1e3-jo.scrollTop}catch(n){t=e.wheelDelta||-e.detail*5}return t}function Xn(e){var t=e.source,n=e.target,r=$n(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function Vn(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function $n(e,t){if(e===t)return e;var n=Vn(e),r=Vn(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function Jn(e){e.fixed|=2}function Kn(e){e.fixed&=1}function Qn(e){e.fixed|=4}function Gn(e){e.fixed&=3}function Yn(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;Yn(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function Zn(){return 20}function er(){return 1}function tr(e){return e.x}function nr(e){return e.y}function rr(e,t,n){e.y0=t,e.y=n}function ir(e){return d3.range(e.length)}function sr(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function or(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function ur(e){return e.reduce(ar,0)}function ar(e,t){return e+t[1]}function fr(e,t){return lr(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function lr(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function cr(e){return[d3.min(e),d3.max(e)]}function hr(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=mr,e.nodes=function(t){return Uo=!0,(e.nodes=e)(t)},e}function pr(e){return e.children}function dr(e){return e.value}function vr(e,t){return t.value-e.value}function mr(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function gr(e,t){return e.value-t.value}function yr(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function br(e,t){e._pack_next=t,t._pack_prev=e}function wr(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function Er(e){function t(e){r=Math.min(e.x-e.r,r),i=Math.max(e.x+e.r,i),s=Math.min(e.y-e.r,s),o=Math.max(e.y+e.r,o)}if(!(n=e.children)||!(p=n.length))return;var n,r=Infinity,i=-Infinity,s=Infinity,o=-Infinity,u,a,f,l,c,h,p;n.forEach(Sr),u=n[0],u.x=-u.r,u.y=0,t(u);if(p>1){a=n[1],a.x=a.r,a.y=0,t(a);if(p>2){f=n[2],Nr(u,a,f),t(f),yr(u,f),u._pack_prev=f,yr(f,a),a=u._pack_next;for(l=3;l<p;l++){Nr(u,a,f=n[l]);var d=0,v=1,m=1;for(c=a._pack_next;c!==a;c=c._pack_next,v++)if(wr(c,f)){d=1;break}if(d==1)for(h=u._pack_prev;h!==c._pack_prev;h=h._pack_prev,m++)if(wr(h,f))break;d?(v<m||v==m&&a.r<u.r?br(u,a=c):br(u=h,a),l--):(yr(u,f),a=f,t(f))}}}var g=(r+i)/2,y=(s+o)/2,b=0;for(l=0;l<p;l++)f=n[l],f.x-=g,f.y-=y,b=Math.max(b,f.r+Math.sqrt(f.x*f.x+f.y*f.y));e.r=b,n.forEach(xr)}function Sr(e){e._pack_next=e._pack_prev=e}function xr(e){delete e._pack_next,delete e._pack_prev}function Tr(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)Tr(i[s],t,n,r)}}function Nr(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function Cr(e){return 1+d3.max(e,function(e){return e.y})}function kr(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Lr(e){var t=e.children;return t&&t.length?Lr(t[0]):e}function Ar(e){var t=e.children,n;return t&&(n=t.length)?Ar(t[n-1]):e}function Or(e,t){return e.parent==t.parent?1:2}function Mr(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function _r(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Dr(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=Dr(n[s],t),e)>0&&(e=r)}return e}function Pr(e,t){return e.x-t.x}function Hr(e,t){return t.x-e.x}function Br(e,t){return e.depth-t.depth}function jr(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function Fr(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function Ir(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function qr(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function Rr(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Ur(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function zr(e,t){function n(e,n){return d3.xhr(e,t,n).response(r)}function r(e){return n.parse(e.responseText)}function i(t){return t.map(s).join(e)}function s(e){return o.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var o=new RegExp('["'+e+"\n]"),u=e.charCodeAt(0);return n.parse=function(e){var t;return n.parseRows(e,function(e){if(t)return t(e);t=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")})},n.parseRows=function(e,t){function n(){if(a>=o)return i;if(c)return c=!1,r;var t=a;if(e.charCodeAt(t)===34){var n=t;while(n++<o)if(e.charCodeAt(n)===34){if(e.charCodeAt(n+1)!==34)break;++n}a=n+2;var s=e.charCodeAt(n+1);return s===13?(c=!0,e.charCodeAt(n+2)===10&&++a):s===10&&(c=!0),e.substring(t+1,n).replace(/""/g,'"')}while(a<o){var s=e.charCodeAt(a++),f=1;if(s===10)c=!0;else if(s===13)c=!0,e.charCodeAt(a)===10&&(++a,++f);else if(s!==u)continue;return e.substring(t,a-f)}return e.substring(t)}var r={},i={},s=[],o=e.length,a=0,f=0,l,c;while((l=n())!==i){var h=[];while(l!==r&&l!==i)h.push(l),l=n();if(t&&!(h=t(h,f++)))continue;s.push(h)}return s},n.format=function(e){return e.map(i).join("\n")},n}function Wr(e){for(var t in zo)t in e||(e[t]=zo[t]);return e}function Xr(e,t){function n(e,t){var n=Math.sqrt(s-2*i*Math.sin(t))/i;return[n*Math.sin(e*=i),o-n*Math.cos(e)]}var r=Math.sin(e),i=(r+Math.sin(t))/2,s=1+r*(2*i-r),o=Math.sqrt(s)/i;return n.invert=function(e,t){var n=o-t;return[Math.atan2(e,n)/i,Math.asin((s-(e*e+n*n)*i*i)/(2*i))]},n}function Vr(e){var t,n,r,i,s=Wr({point:function(s){s=e(s);var o=s[0],u=s[1];o<t&&(t=o),o>r&&(r=o),u<n&&(n=u),u>i&&(i=u)},polygon:function(e){this.line(e[0])}});return function(e){return i=r=-(t=n=Infinity),s.object(e),[[t,n],[r,i]]}}function $r(e,t){function n(e){return Math.cos(e[1])*Math.cos(e[0])>o}function r(e,r,s){if(!(c=e.length))return;var o=t(e[0]),u,a=n(o),f=s!=null,l=f&&a,c,h,p;a&&r.moveTo((h=o)[0],o[1]);for(var d=1;d<c;d++){var v=t(e[d]),m=n(v);if(m!==a)if(a=m){u=i(v,o);if(!p||Math.abs(p[0]-u[0])>Ts||Math.abs(p[1]-u[1])>Ts)h&&(f=!1),r.moveTo((h=u)[0],u[1]);f&&(s+=ui(u,v)),o=u}else p=u=i(o,v),r.lineTo(u[0],u[1]),f&&(Math.abs(h[0]-u[0])>Ts||Math.abs(h[1]-u[1])>Ts?f=!1:s+=ui(o,h)),o=u;f&&(s+=ui(o,v)),m&&r.lineTo(v[0],v[1]),o=v}return l&&m&&r.closePath(),f&&(!h||Math.abs(h[0]-o[0])<Ts&&Math.abs(h[1]-o[1])<Ts)&&s}function i(e,t){var n=Zr(e,[0,0,0]),r=Zr(t,[0,0,0]),i=[1,0,0],s=ni(n,r),u=ti(s,s),a=s[0],f=u-a*a;if(!f)return e;var l=o*u/f,c=-o*a/f,h=ni(i,s),p=ii(i,l),d=ii(s,c);ri(p,d);var v=h,m=ti(p,v),g=ti(v,v),y=Math.sqrt(m*m-g*(ti(p,p)-1)),b=ii(v,(-m-y)/g);return ri(b,p),ei(b)}var s=e*Cs,o=Math.cos(s),u=[o,0,0],a=Yr(u),f=Jr(s,6*Cs);return{point:function(e,r){n(e=t(e))&&r.point(e[0],e[1])},line:function(e,t){r(e,t)},polygon:function(e,t){Kr(e,t,r,f,a)}}}function Jr(e,t){var n=Math.cos(e),r=Math.sin(e);return function(e,i,s,o){var u=s*t;e=e.angle,i=i.angle,e<i&&(e+=2*xs);for(var u=t,a=e;s>0?a>i:a<i;a-=u){var f=Math.cos(a),l=Math.sin(a),c=ei([n,-r*f,-r*l]);o.lineTo(c[0],c[1])}}}function Kr(e,t,n,r,i){var s=[],o=[],u=[],a=oi(n),f=0,l=0;e.forEach(function(e){var n=a(e,t),r=n[1];f+=n[0];var i=r.length;if(!i)return;l+=i;if(typeof n[0]=="number"){var s=r[0],o=s[0],i=s.length-1,c=0;t.moveTo(o[0],o[1]);while(++c<i)t.lineTo((o=s[c])[0],o[1]);t.closePath();return}u=u.concat(r)});if(l?f>0:f<0){var c=!1;ai(r,{lineTo:function(e,n){(c?t.lineTo:(c=!0,t.moveTo))(e,n)}}),t.closePath()}u.forEach(function(e){var t=e[0],n=e[e.length-1],r={point:t,points:e,other:null,visited:!1,entry:!0,subject:!0},u={point:t,angle:i(t),points:[t],other:r,visited:!1,entry:!1,subject:!1};r.other=u,s.push(r),o.push(u),r={point:n,points:[n],other:null,visited:!1,entry:!1,subject:!0},u={point:n,angle:i(n),points:[n],other:r,visited:!1,entry:!0,subject:!1},r.other=u,s.push(r),o.push(u)}),o.sort(Gr),Qr(s),Qr(o);if(!s.length)return;var h=s[0],p,d,v;for(;;){p=h;while(p.visited)if((p=p.next)===h)return;d=p.points,t.moveTo((v=d.shift())[0],v[1]);do{p.visited=p.other.visited=!0;if(p.entry){if(p.subject)for(var m=0;m<d.length;m++)t.lineTo((v=d[m])[0],v[1]);else r
(p,p.next,1,t);p=p.next}else{if(p.subject){d=p.prev.points;for(var m=d.length;--m>=0;)t.lineTo((v=d[m])[0],v[1])}else r(p,p.prev,-1,t);p=p.prev}p=p.other,d=p.points}while(!p.visited);t.closePath()}}function Qr(e){for(var t=0,n=e[0],r,i=e.length;t<i;)n.next=r=e[++t%i],r.prev=n,n=r}function Gr(e,t){return t.angle-e.angle}function Yr(e){return function(t){var n=Zr(t,e);si(n);var r=Math.acos(Math.max(-1,Math.min(1,-n[1])));return((-n[2]<0?-r:r)+2*Math.PI)%(2*Math.PI)}}function Zr(e,t){var n=e[0],r=e[1],i=Math.cos(r);return[i*Math.cos(n)-t[0],i*Math.sin(n)-t[1],Math.sin(r)-t[2]]}function ei(e){return[Math.atan2(e[1],e[0]),Math.asin(Math.max(-1,Math.min(1,e[2])))]}function ti(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ni(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ri(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ii(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function si(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function oi(e){return function(t){var n=[],r;return[e(t,{point:jt,moveTo:function(e,t){n.push(r=[[e,t]])},lineTo:function(e,t){r.push([e,t])},closePath:function(){if(n.length<2)return;n.pop(),n.push(r=r.concat(n.shift()))}},0),n]}}function ui(e,t){var n=Math.cos(e[1]),r=1+Math.cos(e[0])*n,i=Math.cos(t[1]),s=1+Math.cos(t[0])*i;e=[n*Math.sin(e[0])/r,Math.sin(e[1])/r],t=[i*Math.sin(t[0])/s,Math.sin(t[1])/s];if(e[1]<=0){if(t[1]>0&&(e[0]-t[0])*e[1]+e[0]*(t[1]-e[1])>0)return 1}else if(t[1]<=0&&(e[0]-t[0])*e[1]+e[0]*(t[1]-e[1])<0)return-1;return 0}function ai(e,t){for(var n=0;n<4;n++)e({angle:-n*xs/2},{angle:-(n+1)*xs/2},1,t)}function fi(e,t){function n(n,r){var i=e(n,r);return t(i[0],i[1])}return e===li?t:t===li?e:(e.invert&&t.invert&&(n.invert=function(n,r){var i=t.invert(n,r);return e.invert(i[0],i[1])}),n)}function li(e,t){return[e,t]}function ci(e,t,n){var r=d3.range(e,t-Ts,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function hi(e,t,n){var r=d3.range(e,t-Ts,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function pi(){function e(e){var t=Math.sin(e*=p)*d,n=Math.sin(p-e)*d,r=n*s+t*c,u=n*o+t*h,a=n*i+t*l;return[Math.atan2(u,r)/Cs,Math.atan2(a,Math.sqrt(r*r+u*u))/Cs]}var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return e.distance=function(){return p==null&&(d=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,i*l+r*f*Math.cos(u-t)))))),p},e.source=function(u){var a=Math.cos(t=u[0]*Cs),f=Math.sin(t);return r=Math.cos(n=u[1]*Cs),i=Math.sin(n),s=r*a,o=r*f,p=null,e},e.target=function(t){var n=Math.cos(u=t[0]*Cs),r=Math.sin(u);return f=Math.cos(a=t[1]*Cs),l=Math.sin(a),c=f*n,h=f*r,p=null,e},e}function di(e,t){return[e/(2*xs),Math.max(-0.5,Math.min(.5,Math.log(Math.tan(xs/4+t/2))/(2*xs)))]}function vi(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function mi(e){return function(t){var n=[0,0],r=e(n,t.coordinates,0);return r?(n[0]/=r,n[1]/=r,n):null}}function gi(e){return function(t){for(var n=[0,0],r=0,i=t.coordinates,s=0,o=i.length;s<o;++s)r+=e(n,i[s],s);return r?(n[0]/=r,n[1]/=r,n):null}}function yi(e){return function(t){for(var n=[0,0],r=0,i=t.coordinates,s=0,o=i.length;s<o;++s)for(var u=i[s],a=0,f=u.length;a<f;++a)r+=e(n,u[a],a);return r?(n[0]/=r,n[1]/=r,n):null}}function bi(e){return wi(function(){return e})()}function wi(e){function t(e){return e=p(e[0]*Cs,e[1]*Cs),[e[0]*d+S,x-e[1]*d]}function n(e){return e=p.invert((e[0]-S)/d,(x-e[1])/d),[e[0]*ks,e[1]*ks]}function r(e,t){var n=f(e,t);k.point(n[0],n[1])}function i(e,t){var n=f(L=O=e,A=t);M=Math.sin(t),_=Math.cos(t),k.moveTo(D=n[0],P=n[1])}function s(e,t){var n=f(e,t);o(D,P,O,M,_,D=n[0],P=n[1],O=e,M=Math.sin(t),_=Math.cos(t),H),k.lineTo(D,P)}function o(e,t,n,r,i,s,u,a,l,c,h){var p=s-e,d=u-t,v=p*p+d*d;if(v>4*T&&h--){var m=r*l+i*c*Math.cos(a-n),g=1/(Math.SQRT2*Math.sqrt(1+m)),y=g*(i*Math.cos(n)+c*Math.cos(a)),b=g*(i*Math.sin(n)+c*Math.sin(a)),w=Math.max(-1,Math.min(1,g*(r+l))),E=Math.asin(w),S=Math.abs(Math.abs(w)-1),x=S<Ts||S<Ns&&(Math.abs(i)<Ns||Math.abs(c)<Ns)?(n+a)/2:Math.atan2(b,y),N=f(x,E),C=N[0],L=N[1],A=e-C,O=t-L,M=p*O-d*A;if(M*M/v>T){var _=Math.cos(E);o(e,t,n,r,i,C,L,x,w,_,h),k.lineTo(C,L),o(C,L,x,w,_,s,u,a,l,c,h)}}}function u(){var e=f(L,A);o(D,P,O,M,_,e[0],e[1],L,Math.sin(A),Math.cos(A),H),k.closePath()}function a(e){return h(e[0]*Cs,e[1]*Cs)}function f(e,t){var n=c(e,t);return[n[0]*d+S,x-n[1]*d]}function l(){p=fi(h=Ni(b,w,E),c);var e=c(g,y);return S=v-e[0]*d,x=m+e[1]*d,t}var c,h,p,d=150,v=480,m=250,g=0,y=0,b=0,w=0,E=0,S=v,x=m,T=.5,N=Si(a),C=null,k;t.point=function(e,t){k=t,N.point(e,B),k=null},t.line=function(e,t){k=t,N.line(e,B),k=null},t.polygon=function(e,t){k=t,N.polygon(e,B),k=null},t.clipAngle=function(e){return arguments.length?(N=e==null?(C=e,Si(a)):$r(C=+e,a),t):C};var L,A,O,M,_,D,P,H=16,B={point:r,moveTo:i,lineTo:s,closePath:u};return t.scale=function(e){return arguments.length?(d=+e,l()):d},t.translate=function(e){return arguments.length?(v=+e[0],m=+e[1],l()):[v,m]},t.center=function(e){return arguments.length?(g=e[0]%360*Cs,y=e[1]%360*Cs,l()):[g*ks,y*ks]},t.rotate=function(e){return arguments.length?(b=e[0]%360*Cs,w=e[1]%360*Cs,E=e.length>2?e[2]%360*Cs:0,l()):[b*ks,w*ks,E*ks]},t.precision=function(e){return arguments.length?(H=(T=e*e)>0&&16,t):Math.sqrt(T)},function(){return c=e.apply(this,arguments),t.invert=c.invert&&n,l()}}function Ei(e,t,n,r){var i,s,o=Math.sin(e-n);return Math.abs(o)>Ts?Math.atan((Math.sin(t)*(s=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(t))*Math.sin(e))/(i*s*o)):(t+r)/2}function Si(e){var t={point:function(t,n){var r=e(t);n.point(r[0],r[1])},line:function(t,n,r){if(!(d=t.length))return;var i=e(t[0]),s=!0,o=i[0],u=i[1],a,f,l=o>0?xs:-xs,c,h,p=0,d;n.moveTo(o,u);while(++p<d)i=e(t[p]),a=i[0],f=i[1],c=a>0?xs:-xs,h=Math.abs(a-o),Math.abs(h-xs)<Ts?(n.lineTo(o,u=(u+f)/2>0?xs/2:-xs/2),n.lineTo(l,u),n.moveTo(c,u),n.lineTo(a,u),n.lineTo(o=a,u=f),s=!1):l!==c&&h>=xs?(u=Ei(o,u,a,f),Math.abs(o-l)>Ts&&n.lineTo(l,u),Math.abs(a-c)>Ts?(n.moveTo(c,u),n.lineTo(o=a,u=f)):n.moveTo(o=a,u=f),s=!1):n.lineTo(o=a,u=f),l=c;return r!=null&&n.closePath(),s&&r},polygon:function(e,n){Kr(e,n,t.line,Ti,xi)}};return t}function xi(e){return-(e[0]<0?e[1]-xs/2:xs/2-e[1])}function Ti(e,t,n,r){e=e.point,t=t.point;if(Math.abs(e[0]-t[0])>Ts){var i=(e[0]<t[0]?1:-1)*n*xs,s=i/2;r.lineTo(-i,s),r.lineTo(0,s),r.lineTo(i,s)}else r.lineTo(t[0],t[1])}function Ni(e,t,n){return e?t||n?fi(Li(e),Ai(t,n)):Li(e):t||n?Ai(t,n):Ci}function Ci(e,t){return[e>xs?e-2*xs:e<-xs?e+2*xs:e,t]}function ki(e){return function(t,n){return[(t+=e)>xs?t-2*xs:t<-xs?t+2*xs:t,n]}}function Li(e){var t=ki(e);return t.invert=ki(-e),t}function Ai(e,t){function n(e,t){var n=Math.cos(t),u=Math.cos(e)*n,a=Math.sin(e)*n,f=Math.sin(t),l=f*r+u*i;return[Math.atan2(a*s-l*o,u*r-f*i),Math.asin(Math.max(-1,Math.min(1,l*s+a*o)))]}var r=Math.cos(e),i=Math.sin(e),s=Math.cos(t),o=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),u=Math.cos(e)*n,a=Math.sin(e)*n,f=Math.sin(t),l=f*s-a*o;return[Math.atan2(a*s+f*o,u*r+l*i),Math.asin(Math.max(-1,Math.min(1,l*r-u*i)))]},n}function Oi(e,t){function n(t,n){var r=Math.cos(t),i=Math.cos(n),s=e(r*i);return[s*i*Math.sin(t),s*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),i=t(r),s=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*s,r*o),Math.asin(r&&n*s/r)]},n}function Mi(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function _i(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function Di(e,t,n,r){var i=e[0],s=n[0],o=t[0]-i,u=r[0]-s,a=e[1],f=n[1],l=t[1]-a,c=r[1]-f,h=(u*(a-f)-c*(i-s))/(c*o-u*l);return[i+h*o,a+h*l]}function Pi(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[Go[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[Go[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,Go[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function Hi(){return{leaf:!0,nodes:[],point:null}}function Bi(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&Bi(e,a[0],n,r,o,u),a[1]&&Bi(e,a[1],o,r,i,u),a[2]&&Bi(e,a[2],n,u,o,s),a[3]&&Bi(e,a[3],o,u,i,s)}}function ji(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Fi(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a)return-1;i=t.charCodeAt(o++);if(i===37){s=mu[t.charAt(o++)];if(!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function Ii(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")}function qi(e){var t=new o,n=-1,r=e.length;while(++n<r)t.set(e[n].toLowerCase(),n);return t}function Ri(e,t,n){e+="";var r=e.length;return r<n?(new Array(n-r+1)).join(t)+e:e}function Ui(e,t,n){fu.lastIndex=0;var r=fu.exec(t.substring(n));return r?n+=r[0].length:-1}function zi(e,t,n){au.lastIndex=0;var r=au.exec(t.substring(n));return r?n+=r[0].length:-1}function Wi(e,t,n){hu.lastIndex=0;var r=hu.exec(t.substring(n));return r?(e.m=pu.get(r[0].toLowerCase()),n+=r[0].length):-1}function Xi(e,t,n){lu.lastIndex=0;var r=lu.exec(t.substring(n));return r?(e.m=cu.get(r[0].toLowerCase()),n+=r[0].length):-1}function Vi(e,t,n){return Fi(e,vu.c.toString(),t,n)}function $i(e,t,n){return Fi(e,vu.x.toString(),t,n)}function Ji(e,t,n){return Fi(e,vu.X.toString(),t,n)}function Ki(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function Qi(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.y=Gi(+r[0]),n+=r[0].length):-1}function Gi(e){return e+(e>68?1900:2e3)}function Yi(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function Zi(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function es(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function ts(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function ns(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function rs(e,t,n){gu.lastIndex=0;var r=gu.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function is(e,t,n){var r=yu.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function ss(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+Ri(r,"0",2)+Ri(i,"0",2)}function os(e){return e.toISOString()}function us(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new Yo(n-1)),1),n}function s(e,n){return t(e=new Yo(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)while(o<r)n(o)%s||u.push(new Date(+o)),t(o,1);else while(o<r)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{Yo=ji;var r=new ji;return r._=e,o(r,t,n)}finally{Yo=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=as(e);return a.floor=a,a.round=as(r),a.ceil=as(i),a.offset=as(s),a.range=u,e}function as(e){return function(t,n){try{Yo=ji;var r=new ji;return r._=t,e(r,n)._}finally{Yo=Date}}}function fs(e,t,n){function r(t){return e(t)}return r.invert=function(t){return cs(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(cs)},r.nice=function(e){return r.domain(qt(r.domain(),function(){return e}))},r.ticks=function(n,i){var s=ls(r.domain());if(typeof n!="function"){var o=s[1]-s[0],u=o/n,a=d3.bisect(wu,u);if(a==wu.length)return t.year(s,n);if(!a)return e.ticks(n).map(cs);Math.log(u/wu[a-1])<Math.log(wu[a]/u)&&--a,n=t[a],i=n[1],n=n[0].range}return n(s[0],new Date(+s[1]+1),i)},r.tickFormat=function(){return n},r.copy=function(){return fs(e.copy(),t,n)},d3.rebind(r,e,"range","rangeRound","interpolate","clamp")}function ls(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function cs(e){return new Date(e)}function hs(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t))r=e[--n];return r[0](t)}}function ps(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function ds(e){var t=e.getFullYear(),n=ps(t),r=ps(t+1);return t+(e-n)/(r-n)}function vs(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function ms(e){var t=e.getUTCFullYear(),n=vs(t),r=vs(t+1);return t+(e-n)/(r-n)}var gs=".",ys=",",bs=[3,3];Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(ws){var Es=CSSStyleDeclaration.prototype,Ss=Es.setProperty;Es.setProperty=function(e,t,n){Ss.call(this,e,t+"",n)}}d3={version:"3.0.0pre"};var xs=Math.PI,Ts=1e-6,Ns=.001,Cs=xs/180,ks=180/xs,Ls=s;try{Ls(document.documentElement.childNodes)[0].nodeType}catch(As){Ls=i}var Os=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.map=function(e){var t=new o;for(var n in e)t.set(n,e[n]);return t},r(o,{has:function(e){return Ms+e in this},get:function(e){return this[Ms+e]},set:function(e,t){return this[Ms+e]=t},remove:function(e){return e=Ms+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===_s&&e.call(this,t.substring(1),this[t])}});var Ms="\0",_s=Ms.charCodeAt(0);d3.functor=f,d3.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=l(e,t,t[i]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1)while(++s<n)c(r=e[s])&&(i+=(r-i)/++o);else while(++s<n)c(r=t.call(e,e[s],s))&&(i+=(r-i)/++o);return o?i:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(c),e.length?d3.quantile(e.sort(d3.ascending),.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var r=d3.random.normal();return function(){return Math.exp(e+t*r())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=d3.min(arguments,h),n=new Array(t);++e<t;)for(var r=-1,i,s=n[e]=new Array(i);++r<i;)s[r]=arguments[r][e];return n},d3.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var Ds=d3.bisector(function(e){return e});d3.bisectLeft=Ds.left,d3.bisect=d3.bisectRight=Ds.right,d3.nest=function(){function e(t,i){if(i>=r.length)return u?u.call(n,t):s?t.sort(s):t;var a=-1,f=t.length,l=r[i++],c,h,p=new o,d,v={};while(++a<f)(d=p.get(c=l(h=t[a])))?d.push(h):p.set(c,[h]);return p.forEach(function(t,n){v[t]=e(n,i)}),v}function t(e,n){if(n>=r.length)return e;var s=[],o=i[n++],u;for(u in e)s.push({key:u,values:t(e[u],n)});return o&&s.sort(function(e,t){return o(e.key,t.key)}),s}var n={},r=[],i=[],s,u;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return r.push(e),n},n.sortKeys=function(e){return i[r.length-1]=e,n},n.sortValues=function(e){return s=e,n},n.rollup=function(e){return u=e,n},n},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=d(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},d3.requote=function(e){return e.replace(Ps,"\\$&")};var Ps=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){var r={},i=d3.dispatch("progress","load","error"),s={},o=u,a=new XMLHttpRequest;return a.onreadystatechange=function(){if(a.readyState===4){var e=a.status;!e&&a.response||e>=200&&e<300||e===304?i.load.call(r,o.call(r,a)):i.error.call(r,a)}},a.onprogress=function(e){var t=d3.event;d3.event=e;try{i.progress.call(r,a)}finally{d3.event=t}},r.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?s[e]:(t==null?delete s[e]:s[e]=t+"",r)},r.mimeType=function(e){return arguments.length?(t=e==null?null:e+"",r):t},r.response=function(e){return o=e,r},["get","post"].forEach(function(e){r[e]=function(){return r.send.apply(r,[e].concat(Ls(arguments)))}}),r.send=function(n,i,o){arguments.length===2&&typeof i=="function"&&(o=i,i=null),a.open(n,e,!0),t!=null&&!("accept"in s)&&(s.accept=t+",*/*");for(var u in s)a.setRequestHeader(u,s[u]);return t!=null&&a.overrideMimeType&&a.overrideMimeType(t),o!=null&&r.on("error",o).on("load",function(e){o(null,e)}),a.send(i==null?null:i),r},r.abort=function(){return a.abort(),r},d3.rebind(r,i,"on"),arguments.length===2&&typeof t=="function"&&(n=t,t=null),n==null?r:r.get(n)},d3.text=function(){return d3.xhr.apply(d3,arguments).response(v)},d3.json=function(e,t){return d3.xhr(e,"application/json",t).response(m)},d3.html=function(e,t){return d3.xhr(e,"text/html",t).response(g)},d3.xml=function(){return d3.xhr.apply(d3,arguments).response(y)};var Hs={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:Hs,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),Hs.hasOwnProperty(n)?{space:Hs[n],local:e}:e}},d3.dispatch=function(){var e=new b,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=w(e);return e},b.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},d3.format=function(e){var t=Bs.exec(e),n=t[1]||" ",r=t[2]||">",i=t[3]||"",s=t[4]||"",o=t[5],u=+t[6],a=t[7],f=t[8],l=t[9],c=1,h="",p=!1;f&&(f=+f.substring(1));if(o||n==="0"&&r==="=")o=n="0",r="=",a&&(u-=Math.floor((u-1)/4));switch(l){case"n":a=!0,l="g";break;case"%":c=100,h="%",l="f";break;case"p":c=100,h="%",l="r";break;case"b":case"o":case"x":case"X":s&&(s="0"+l.toLowerCase());case"c":case"d":p=!0,f=0;break;case"s":c=-1,l="r"}s==="#"&&(s=""),l=="r"&&!f&&(l="g"),l=js.get(l)||S;var d=o&&a;return function(e){if(p&&e%1)return"";var t=e<0||e===0&&1/e<0?(e=-e,"-"):i;if(c<0){var v=d3.formatPrefix(e,f);e=v.scale(e),h=v.symbol}else e*=c;e=l(e,f),!o&&a&&(e=Fs(e));var m=s.length+e.length+(d?0:t.length),g=m<u?(new Array(m=u-m+1)).join(n):"";return d&&(e=Fs(g+e)),gs&&e.replace(".",gs),t+=s,(r==="<"?t+e+g:r===">"?g+t+e:r==="^"?g.substring(0,m>>=1)+t+e+g.substring(m):t+(d?e:g+e))+h}};var Bs=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,js=d3.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=E(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),Fs=u;if(bs){var Is=bs.length;Fs=function(e){var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1):(t=e.length,""),r=[],i=0,s=bs[0];while(t>0&&s>0)r.push(e.substring(t-=s,t+s)),s=bs[i=(i+1)%Is];return r.reverse().join(ys||"")+n}}var qs=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(x);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,E(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),qs[8+n/3]};var Rs=function(){return u},Us=d3.map({linear:Rs,poly:O,quad:function(){return k},cubic:function(){return L},sin:function(){return M},exp:function(){return _},circle:function(){return D},elastic:P,back:H,bounce:function(){return B}}),zs=d3.map({"in":u,out:N,"in-out":C,"out-in":function(e){return C(N(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=Us.get(n)||Rs,r=zs.get(r)||u,T(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new q(n?n.matrix:Ws)})(e)},q.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ws={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t)));return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;Xs.lastIndex=0;for(r=0;n=Xs.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=Xs.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=Xs.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){var n=[],r=[],i,s=d3.transform(e),o=d3.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(u[0],a[0])},{i:3,x:d3.interpolateNumber(u[1],a[1])})):a[0]||a[1]?n.push("translate("+a+")"):n.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(f,l)})):l&&n.push(n.pop()+"rotate("+l+")"),c!=h?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(c,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:d3.interpolateNumber(p[0],d[0])},{i:i-2,x:d3.interpolateNumber(p[1],d[1])})):(d[0]!=1||d[1]!=1)&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){var t=-1,s;while(++t<i)n[(s=r[t]).i]=s.x(e);return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+Q(Math.round(n+s*e))+Q(Math.round(r+o*e))+Q(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return it(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return lt(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return ut(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(d3.interpolate(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=W(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var Xs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&d3.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?$s.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof $)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],$.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(e,t,n){return arguments.length===1?e instanceof K?J(e.r,e.g,e.b):G(""+e,J,it):J(~~e,~~t,~~n)};var Vs=K.prototype=new $;Vs.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?J(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),J(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},Vs.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),J(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},Vs.hsl=function(){return Y(this.r,this.g,this.b)},Vs.toString=function(){return"#"+Q(this.r)+Q(this.g)+Q(this.b)};var $s=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa"
    ,springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});$s.forEach(function(e,t){$s.set(e,G(t,J,it))}),d3.hsl=function(e,t,n){return arguments.length===1?e instanceof rt?nt(e.h,e.s,e.l):G(""+e,Y,nt):nt(+e,+t,+n)};var Js=rt.prototype=new $;Js.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),nt(this.h,this.s,this.l/e)},Js.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),nt(this.h,this.s,e*this.l)},Js.rgb=function(){return it(this.h,this.s,this.l)},d3.hcl=function(e,t,n){return arguments.length===1?e instanceof ot?st(e.h,e.c,e.l):e instanceof ft?ct(e.l,e.a,e.b):ct((e=Z((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):st(+e,+t,+n)};var Ks=ot.prototype=new $;Ks.brighter=function(e){return st(this.h,this.c,Math.min(100,this.l+Qs*(arguments.length?e:1)))},Ks.darker=function(e){return st(this.h,this.c,Math.max(0,this.l-Qs*(arguments.length?e:1)))},Ks.rgb=function(){return ut(this.h,this.c,this.l).rgb()},d3.lab=function(e,t,n){return arguments.length===1?e instanceof ft?at(e.l,e.a,e.b):e instanceof ot?ut(e.l,e.c,e.h):Z((e=d3.rgb(e)).r,e.g,e.b):at(+e,+t,+n)};var Qs=18,Gs=.95047,Ys=1,Zs=1.08883,eo=ft.prototype=new $;eo.brighter=function(e){return at(Math.min(100,this.l+Qs*(arguments.length?e:1)),this.a,this.b)},eo.darker=function(e){return at(Math.max(0,this.l-Qs*(arguments.length?e:1)),this.a,this.b)},eo.rgb=function(){return lt(this.l,this.a,this.b)};var to=function(e,t){return t.querySelector(e)},no=function(e,t){return t.querySelectorAll(e)},ro=document.documentElement,io=ro.matchesSelector||ro.webkitMatchesSelector||ro.mozMatchesSelector||ro.msMatchesSelector||ro.oMatchesSelector,so=function(e,t){return io.call(e,t)};typeof Sizzle=="function"&&(to=function(e,t){return Sizzle(e,t)[0]||null},no=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},so=Sizzle.matchesSelector);var oo=[];d3.selection=function(){return uo},d3.selection.prototype=oo,oo.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=mt(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return vt(t)},oo.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=gt(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=Ls(e.call(r,r.__data__,u))),n.parentNode=r;return vt(t)},oo.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(yt(t,e[t]));return this}return this.each(yt(e,t))},oo.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r)if(!bt(e[i]).test(t))return!1}return!0}for(t in e)this.each(wt(t,e[t]));return this}return this.each(wt(e,t))},oo.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.each(St(n,e[n],t));return this}if(r<2)return getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(St(e,t,n))},oo.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each(xt(t,e[t]));return this}return this.each(xt(e,t))},oo.text=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},oo.html=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},oo.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},oo.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),to(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),to(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},oo.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},oo.data=function(e,t){function n(e,n){var r,i=e.length,s=n.length,u=Math.min(i,s),c=Math.max(i,s),h=[],p=[],d=[],v,m;if(t){var g=new o,y=[],b,w=n.length;for(r=-1;++r<i;)b=t.call(v=e[r],v.__data__,r),g.has(b)?d[w++]=v:g.set(b,v),y.push(b);for(r=-1;++r<s;)b=t.call(n,m=n[r],r),g.has(b)?(h[r]=v=g.get(b),v.__data__=m,p[r]=d[r]=null):(p[r]=Tt(m),h[r]=d[r]=null),g.remove(b);for(r=-1;++r<i;)g.has(y[r])&&(d[r]=e[r])}else{for(r=-1;++r<u;)v=e[r],m=n[r],v?(v.__data__=m,h[r]=v,p[r]=d[r]=null):(p[r]=Tt(m),h[r]=d[r]=null);for(;r<s;++r)p[r]=Tt(n[r]),h[r]=d[r]=null;for(;r<c;++r)d[r]=e[r],p[r]=h[r]=null}p.update=h,p.parentNode=h.parentNode=d.parentNode=e.parentNode,a.push(p),f.push(h),l.push(d)}var r=-1,i=this.length,s,u;if(!arguments.length){e=new Array(i=(s=this[0]).length);while(++r<i)if(u=s[r])e[r]=u.__data__;return e}var a=At([]),f=vt([]),l=vt([]);if(typeof e=="function")while(++r<i)n(s=this[r],e.call(s,s.parentNode.__data__,r));else while(++r<i)n(s=this[r],e);return f.enter=function(){return a},f.exit=function(){return l},f},oo.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},oo.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=Nt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return vt(t)},oo.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},oo.sort=function(e){e=Ct.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},oo.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(kt(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(kt(e,t,n))},oo.each=function(e){return Lt(this,function(t,n,r){e.call(t,t.__data__,n,r)})},oo.call=function(e){var t=Ls(arguments);return e.apply(t[0]=this,t),this},oo.empty=function(){return!this.node()},oo.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,i=n.length;r<i;r++){var s=n[r];if(s)return s}return null},oo.transition=function(){var e=co||++lo,t=[],n,r,i=Object.create(ho);i.time=Date.now();for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(r=u[a])&&Mt(r,a,e,i),n.push(r)}return Ot(t,e)};var uo=vt([[document]]);uo[0].parentNode=ro,d3.select=function(e){return typeof e=="string"?uo.select(e):vt([[e]])},d3.selectAll=function(e){return typeof e=="string"?uo.selectAll(e):vt([Ls(e)])};var ao=[];d3.selection.enter=At,d3.selection.enter.prototype=ao,ao.append=oo.append,ao.insert=oo.insert,ao.empty=oo.empty,ao.node=oo.node,ao.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return vt(t)};var fo=[],lo=0,co,ho={ease:A,delay:0,duration:250};fo.call=oo.call,fo.empty=oo.empty,fo.node=oo.node,d3.transition=function(e){return arguments.length?co?e.transition():e:uo.transition()},d3.transition.prototype=fo,fo.select=function(e){var t=this.id,n=[],r,i,s;typeof e!="function"&&(e=mt(e));for(var o=-1,u=this.length;++o<u;){n.push(r=[]);for(var a=this[o],f=-1,l=a.length;++f<l;)(s=a[f])&&(i=e.call(s,s.__data__,f))?("__data__"in s&&(i.__data__=s.__data__),Mt(i,f,t,s.__transition__[t]),r.push(i)):r.push(null)}return Ot(n,t)},fo.selectAll=function(e){var t=this.id,n=[],r,i,s,o,u;typeof e!="function"&&(e=gt(e));for(var a=-1,f=this.length;++a<f;)for(var l=this[a],c=-1,h=l.length;++c<h;)if(s=l[c]){u=s.__transition__[t],i=e.call(s,s.__data__,c),n.push(r=[]);for(var p=-1,d=i.length;++p<d;)Mt(o=i[p],p,t,u),r.push(o)}return Ot(n,t)},fo.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=Nt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return Ot(t,this.id,this.time).ease(this.ease())},fo.attr=function(e,t){function n(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var i=W(e),s=d3.ns.qualify(e);return Dt(this,"attr."+e,t,function(e){function t(){var t=this.getAttribute(s),n;return t!==e&&(n=i(t,e),function(e){this.setAttribute(s,n(e))})}function o(){var t=this.getAttributeNS(s.space,s.local),n;return t!==e&&(n=i(t,e),function(e){this.setAttributeNS(s.space,s.local,n(e))})}return e==null?s.local?r:n:(e+="",s.local?o:t)})},fo.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},fo.style=function(e,t,n){function r(){this.style.removeProperty(e)}var i=arguments.length;if(i<3){if(typeof e!="string"){i<2&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}var s=W(e);return Dt(this,"style."+e,t,function(t){function i(){var r=getComputedStyle(this,null).getPropertyValue(e),i;return r!==t&&(i=s(r,t),function(t){this.style.setProperty(e,i(t),n)})}return t==null?r:(t+="",i)})},fo.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,getComputedStyle(this,null).getPropertyValue(e));return s&&function(t){this.style.setProperty(e,s(t),n)}})},fo.text=function(e){return Dt(this,"text",e,_t)},fo.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},fo.ease=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:(typeof e!="function"&&(e=d3.ease.apply(d3,arguments)),Lt(this,function(n){n.__transition__[t].ease=e}))},fo.delay=function(e){var t=this.id;return Lt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].delay=e.call(n,n.__data__,r,i)|0}:(e|=0,function(n){n.__transition__[t].delay=e}))},fo.duration=function(e){var t=this.id;return Lt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].duration=Math.max(1,e.call(n,n.__data__,r,i)|0)}:(e=Math.max(1,e|0),function(n){n.__transition__[t].duration=e}))},fo.each=function(e,t){var n=this.id;if(arguments.length<2){var r=ho,i=co;co=n,Lt(this,function(t,r,i){ho=t.__transition__[n],e.call(t,t.__data__,r,i)}),ho=r,co=i}else Lt(this,function(r){r.__transition__[n].event.on(e,t)});return this},fo.transition=function(){var e=this.id,t=++lo,n=[],r,i,s,o;for(var u=0,a=this.length;u<a;u++){n.push(r=[]);for(var i=this[u],f=0,l=i.length;f<l;f++){if(s=i[f])o=Object.create(s.__transition__[e]),o.delay+=o.duration,Mt(s,f,t,o);r.push(s)}}return Ot(n,t)},fo.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):Lt(this,t==null?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})};var po=0,vo={},mo=null,go,yo;d3.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=vo[e.id];r&&r.callback===e?(r.then=n,r.delay=t):vo[e.id=++po]=mo={callback:e,then:n,delay:t,next:mo},go||(yo=clearTimeout(yo),go=1,bo(Pt))},d3.timer.flush=function(){var e,t=Date.now(),n=mo;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;Ht()};var bo=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return Bt(e,F())};var wo=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=F().touches),t?Ls(t).map(function(t){var n=Bt(e,t);return n.identifier=t.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return Ut([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Qt(d3.scale.linear(),Gt)};var Eo=d3.format(".0e");Gt.pow=function(e){return Math.pow(10,e)},Yt.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return Zt(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return tn([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(So)},d3.scale.category20=function(){return d3.scale.ordinal().range(xo)},d3.scale.category20b=function(){return d3.scale.ordinal().range(To)},d3.scale.category20c=function(){return d3.scale.ordinal().range(No)};var So=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],xo=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],To=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],No=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return nn([],[])},d3.scale.quantize=function(){return rn(0,1,[0,1])},d3.scale.threshold=function(){return sn([.5],[0,1])},d3.scale.identity=function(){return on([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+Co,u=i.apply(this,arguments)+Co,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<xs?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=ko?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var t=un,n=an,r=fn,i=ln;return e.innerRadius=function(n){return arguments.length?(t=f(n),e):t},e.outerRadius=function(t){return arguments.length?(n=f(t),e):n},e.startAngle=function(t){return arguments.length?(r=f(t),e):r},e.endAngle=function(t){return arguments.length?(i=f(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+Co;return[Math.cos(s)*e,Math.sin(s)*e]},e};var Co=-xs/2,ko=2*xs-1e-6;d3.svg.line=function(){return cn(u)};var Lo=d3.map({linear:dn,"linear-closed":vn,"step-before":mn,"step-after":gn,basis:xn,"basis-open":Tn,"basis-closed":Nn,bundle:Cn,cardinal:wn,"cardinal-open":yn,"cardinal-closed":bn,monotone:_n});Lo.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Ao=[0,2/3,1/3,0],Oo=[0,1/3,2/3,0],Mo=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=cn(Dn);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},mn.reverse=gn,gn.reverse=mn,d3.svg.area=function(){return Pn(u)},d3.svg.area.radial=function(){var e=Pn(Dn);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,t){var n=r(this,u,e,t),f=r(this,a,e,t);return"M"+n.p0+s(n.r,n.p1,n.a1-n.a0)+(i(n,f)?o(n.r,n.p1,n.r,n.p0):o(n.r,n.p1,f.r,f.p0)+s(f.r,f.p1,f.a1-f.a0)+o(f.r,f.p1,n.r,n.p0))+"Z"}function r(e,t,n,r){var i=t.call(e,n,r),s=l.call(e,i,r),o=c.call(e,i,r)+Co,u=h.call(e,i,r)+Co;return{r:s,a0:o,a1:u,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(u),s*Math.sin(u)]}}function i(e,t){return e.a0==t.a0&&e.a1==t.a1}function s(e,t,n){return"A"+e+","+e+" 0 "+ +(n>xs)+",1 "+t}function o(e,t,n,r){return"Q 0,0 "+r}var u=n,a=t,l=Hn,c=fn,h=ln;return e.radius=function(t){return arguments.length?(l=f(t),e):l},e.source=function(t){return arguments.length?(u=f(t),e):u},e.target=function(t){return arguments.length?(a=f(t),e):a},e.startAngle=function(t){return arguments.length?(c=f(t),e):c},e.endAngle=function(t){return arguments.length?(h=f(t),e):h},e},d3.svg.diagonal=function(){function e(e,t){var n=r.call(this,e,t),o=i.call(this,e,t),u=(n.y+o.y)/2,a=[n,{x:n.x,y:u},{x:o.x,y:u},o];return a=a.map(s),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var r=n,i=t,s=Bn;return e.source=function(t){return arguments.length?(r=f(t),e):r},e.target=function(t){return arguments.length?(i=f(t),e):i},e.projection=function(t){return arguments.length?(s=t,e):s},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Bn,n=e.projection;return e.projection=function(e){return arguments.length?n(jn(t=e)):t},e},d3.svg.symbol=function(){function e(e,r){return(_o.get(t.call(this,e,r))||qn)(n.call(this,e,r))}var t=In,n=Fn;return e.type=function(n){return arguments.length?(t=f(n),e):t},e.size=function(t){return arguments.length?(n=f(t),e):n},e};var _o=d3.map({circle:qn,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Po)),n=t*Po;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Do),n=t*Do/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Do),n=t*Do/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});d3.svg.symbolTypes=_o.keys();var Do=Math.sqrt(3),Po=Math.tan(30*Cs);d3.svg.axis=function(){function e(e){e.each(function(){var e=d3.select(this),c=a==null?t.ticks?t.ticks.apply(t,u):t.domain():a,h=f==null?t.tickFormat?t.tickFormat.apply(t,u):String:f,p=zn(t,c,l),d=e.selectAll(".minor").data(p,String),v=d.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),m=d3.transition(d.exit()).style("opacity",1e-6).remove(),g=d3.transition(d).style("opacity",1),y=e.selectAll("g").data(c,String),b=y.enter().insert("g","path").style("opacity",1e-6),w=d3.transition(y.exit()).style("opacity",1e-6).remove(),E=d3.transition(y).style("opacity",1),S,x=It(t),T=e.selectAll(".domain").data([0]),N=d3.transition(T),C=t.copy(),k=this.__chart__||C;this.__chart__=C,T.enter().append("path").attr("class","domain"),b.append("line").attr("class","tick"),b.append("text");var L=b.select("line"),A=E.select("line"),O=y.select("text").text(h),M=b.select("text"),_=E.select("text");switch(n){case"bottom":S=Rn,v.attr("y2",i),g.attr("x2",0).attr("y2",i),L.attr("y2",r),M.attr("y",Math.max(r,0)+o),A.attr("x2",0).attr("y2",r),_.attr("x",0).attr("y",Math.max(r,0)+o),O.attr("dy",".71em").style("text-anchor","middle"),N.attr("d","M"+x[0]+","+s+"V0H"+x[1]+"V"+s);break;case"top":S=Rn,v.attr("y2",-i),g.attr("x2",0).attr("y2",-i),L.attr("y2",-r),M.attr("y",-(Math.max(r,0)+o)),A.attr("x2",0).attr("y2",-r),_.attr("x",0).attr("y",-(Math.max(r,0)+o)),O.attr("dy","0em").style("text-anchor","middle"),N.attr("d","M"+x[0]+","+ -s+"V0H"+x[1]+"V"+ -s);break;case"left":S=Un,v.attr("x2",-i),g.attr("x2",-i).attr("y2",0),L.attr("x2",-r),M.attr("x",-(Math.max(r,0)+o)),A.attr("x2",-r).attr("y2",0),_.attr("x",-(Math.max(r,0)+o)).attr("y",0),O.attr("dy",".32em").style("text-anchor","end"),N.attr("d","M"+ -s+","+x[0]+"H0V"+x[1]+"H"+ -s);break;case"right":S=Un,v.attr("x2",i),g.attr("x2",i).attr("y2",0),L.attr("x2",r),M.attr("x",Math.max(r,0)+o),A.attr("x2",r).attr("y2",0),_.attr("x",Math.max(r,0)+o).attr("y",0),O.attr("dy",".32em").style("text-anchor","start"),N.attr("d","M"+s+","+x[0]+"H0V"+x[1]+"H"+s)}if(t.ticks)b.call(S,k),E.call(S,C),w.call(S,C),v.call(S,k),g.call(S,C),m.call(S,C);else{var D=C.rangeBand()/2,P=function(e){return C(e)+D};b.call(S,P),E.call(S,P)}})}var t=d3.scale.linear(),n="bottom",r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickValues=function(t){return arguments.length?(a=t,e):a},e.tickFormat=function(t){return arguments.length?(f=t,e):f},e.tickSize=function(t,n){if(!arguments.length)return r;var o=arguments.length-1;return r=+t,i=o>1?+n:r,s=o>0?+arguments[o]:r,e},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(t){return arguments.length?(l=+t,e):l},e},d3.svg.brush=function(){function e(s){s.each(function(){var s=d3.select(this),f=s.selectAll(".background").data([0]),l=s.selectAll(".extent").data([0]),c=s.selectAll(".resize").data(a,String),h;s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),f.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),l.enter().append("rect").attr("class","extent").style("cursor","move"),c.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Ho[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",e.empty()?"none":null),c.exit().remove(),o&&(h=It(o),f.attr("x",h[0]).attr("width",h[1]-h[0]),n(s)),u&&(h=It(u),f.attr("y",h[0]).attr("height",h[1]-h[0]),r(s)),t(s)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+f[+/e$/.test(e)][0]+","+f[+/^s/.test(e)][1]+")"})}function n(e){e.select(".extent").attr("x",f[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1][0]-f[0][0])}function r(e){e.select(".extent").attr("y",f[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1][1]-f[0][1])}function i(){function i(){var e=d3.event.changedTouches;return e?d3.touches(v,e)[0]:d3.mouse(v)}function a(){d3.event.keyCode==32&&(S||(x=null,T[0]-=f[1][0],T[1]-=f[1][1],S=2),j())}function c(){d3.event.keyCode==32&&S==2&&(T[0]+=f[1][0],T[1]+=f[1][1],S=0,j())}function h(){var e=i(),s=!1;N&&(e[0]+=N[0],e[1]+=N[1]),S||(d3.event.altKey?(x||(x=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]),T[0]=f[+(e[0]<x[0])][0],T[1]=f[+(e[1]<x[1])][1]):x=null),w&&p(e,o,0)&&(n(y),s=!0),E&&p(e,u,1)&&(r(y),s=!0),s&&(t(y),g({type:"brush",mode:S?"move":"resize"}))}function p(e,t,n){var r=It(t),i=r[0],s=r[1],o=T[n],u=f[1][n]-f[0][n],a,c;S&&(i-=o,s-=u+o),a=Math.max(i,Math.min(s,e[n])),S?c=(a+=o)+u:(x&&(o=Math.max(i,Math.min(s,2*x[n]-a))),o<a?(c=a,a=o):c=o);if(f[0][n]!==a||f[1][n]!==c)return l=null,f[0][n]=a,f[1][n]=c,!0}function d(){h(),y.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),g({type:"brushend"}),j()}var v=this,m=d3.select(d3.event.target),g=s.of(v,arguments),y=d3.select(v),b=m.datum(),w=!/^(n|s)$/.test(b)&&o,E=!/^(e|w)$/.test(b)&&u,S=m.classed("extent"),x,T=i(),N,C=d3.select(window).on("mousemove.brush",h).on("mouseup.brush",d).on("touchmove.brush",h).on("touchend.brush",d).on("keydown.brush",a).on("keyup.brush",c);if(S)T[0]=f[0][0]-T[0],T[1]=f[0][1]-T[1];else if(b){var k=+/w$/.test(b),L=+/^n/.test(b);N=[f[1-k][0]-T[0],f[1-L][1]-T[1]],T[0]=f[k][0],T[1]=f[L][1]}else d3.event.altKey&&(x=T.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",m.style("cursor")),g({type:"brushstart"}),h(),j()}var s=I(e,"brushstart","brush","brushend"),o=null,u=null,a=Bo[0],f=[[0,0],[0,0]],l;return e.x=function(t){return arguments.length?(o=t,a=Bo[!o<<1|!u],e):o},e.y=function(t){return arguments.length?(u=t,a=Bo[!o<<1|!u],e):u},e.extent=function(t){var n,r,i,s,a;return arguments.length?(l=[[0,0],[0,0]],o&&(n=t[0],r=t[1],u&&(n=n[0],r=r[0]),l[0][0]=n,l[1][0]=r,o.invert&&(n=o(n),r=o(r)),r<n&&(a=n,n=r,r=a),f[0][0]=n|0,f[1][0]=r|0),u&&(i=t[0],s=t[1],o&&(i=i[1],s=s[1]),l[0][1]=i,l[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(a=i,i=s,s=a),f[0][1]=i|0,f[1][1]=s|0),e):(t=l||f,o&&(n=t[0][0],r=t[1][0],l||(n=f[0][0],r=f[1][0],o.invert&&(n=o.invert(n),r=o.invert(r)),r<n&&(a=n,n=r,r=a))),u&&(i=t[0][1],s=t[1][1],l||(i=f[0][1],s=f[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(a=i,i=s,s=a))),o&&u?[[n,i],[r,s]]:o?[n,r]:u&&[i,s])},e.clear=function(){return l=null,f[0][0]=f[0][1]=f[1][0]=f[1][1]=0,e},e.empty=function(){return o&&f[0][0]===f[1][0]||u&&f[0][1]===f[1][1]},d3.rebind(e,s,"on")};var Ho={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Bo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=o.parentNode;return f?d3.touches(e).filter(function(e){return e.identifier===f})[0]:d3.mouse(e)}function t(){if(!o.parentNode)return i();var t=e(),n=t[0]-c[0],r=t[1]-c[1];h|=n|r,c=t,j(),u({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:r})}function i(){u({type:"dragend"}),h&&(j(),d3.event.target===a&&p.on("click.drag",s,!0)),p.on(f?"touchmove.drag-"+f:"mousemove.drag",null).on(f?"touchend.drag-"+f:"mouseup.drag",null)}function s(){j(),p.on("click.drag",null)}var o=this,u=n.of(o,arguments),a=d3.event.target,f=d3.event.touches&&d3.event.changedTouches[0].identifier,l,c=e(),h=0,p=d3.select(window).on(f?"touchmove.drag-"+f:"mousemove.drag",t).on(f?"touchend.drag-"+f:"mouseup.drag",i,!0);r?(l=r.apply(o,arguments),l=[l.x-c[0],l.y-c[1]]):l=[0,0],f||j(),u({type:"dragstart"})}var n=I(e,"drag","dragstart","dragend"),r=null;return e.origin=function(t){return arguments.length?(r=t,e):r},d3.rebind(e,n,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",u).on("mousewheel.zoom",a).on("mousemove.zoom",f).on("DOMMouseScroll.zoom",a).on("dblclick.zoom",l).on("touchstart.zoom",c).on("touchmove.zoom",h).on("touchend.zoom",c)}function t(e){return[(e[0]-p[0])/v,(e[1]-p[1])/v]}function n(e){return[e[0]*v+p[0],e[1]*v+p[1]]}function r(e){v=Math.max(g[0],Math.min(g[1],e))}function i(e,t){t=n(t),p[0]+=e[0]-t[0],p[1]+=e[1]-t[1]}function s(){w&&w.domain(b.range().map(function(e){return(e-p[0])/v}).map(b.invert)),S&&S.domain(E.range().map(function(e){return(e-p[1])/v}).map(E.invert))}function o(e){s(),d3.event.preventDefault(),e({type:"zoom",scale:v,translate:p})}function u(){function e(){f=1,i(d3.mouse(s),c),o(u)}function n(){f&&j(),l.on("mousemove.zoom",null).on("mouseup.zoom",null),f&&d3.event.target===a&&l.on("click.zoom",r,!0)}function r(){j(),l.on("click.zoom",null)}var s=this,u=y.of(s,arguments),a=d3.event.target,f=0,l=d3.select(window).on("mousemove.zoom",e).on("mouseup.zoom",n),c=t(d3.mouse(s));window.focus(),j()}function a(){d||(d=t(d3.mouse(this))),r(Math.pow(2,Wn()*.002)*v),i(d3.mouse(this),d),o(y.of(this,arguments))}function f(){d=null}function l(){var e=d3.mouse(this),n=t(e),s=Math.log(v)/Math.LN2;r(Math.pow(2,d3.event.shiftKey?Math.ceil(s)-1:Math.floor(s)+1)),i(e,n),o(y.of(this,arguments))}function c(){var e=d3.touches(this),n=Date.now();m=v,d={},e.forEach(function(e){d[e.identifier]=t(e)}),j();if(e.length===1){if(n-x<500){var s=e[0],u=t(e[0]);r(v*2),i(s,u),o(y.of(this,arguments))}x=n}}function h(){var e=d3.touches(this),t=e[0],n=d[t.identifier];if(s=e[1]){var s,u=d[s.identifier];t=[(t[0]+s[0])/2,(t[1]+s[1])/2],n=[(n[0]+u[0])/2,(n[1]+u[1])/2],r(d3.event.scale*m)}i(t,n),x=null,o(y.of(this,arguments))}var p=[0,0],d,v=1,m,g=Fo,y=I(e,"zoom"),b,w,E,S,x;return e.translate=function(t){return arguments.length?(p=t.map(Number),s(),e):p},e.scale=function(t){return arguments.length?(v=+t,s(),e):v},e.scaleExtent=function(t){return arguments.length?(g=t==null?Fo:t.map(Number),e):g},e.x=function(t){return arguments.length?(w=t,b=t.copy(),p=[0,0],v=1,e):w},e.y=function(t){return arguments.length?(S=t,E=t.copy(),p=[0,0],v=1,e):S},d3.rebind(e,y,"on")};var jo,Fo=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(Xn(e[n]));return t}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,d,v,m,g;r=[],i=[],p=0,m=-1;while(++m<o){d=0,g=-1;while(++g<o)d+=s[m][g];n.push(d),h.push(d3.range(o)),p+=d}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*xs-u*o)/p,d=0,m=-1;while(++m<o){v=d,g=-1;while(++g<o){var y=c[m],b=h[y][g],w=s[y][b],E=d,S=d+=w*p;e[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}i[y]={index:y,startAngle:v,endAngle:d,value:(d-v)/p},d+=u}m=-1;while(++m<o){g=m-1;while(++g<o){var x=e[m+"-"+g],T=e[g+"-"+m];(x.value||T.value)&&r.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i){if(t.point!==e){var s=t.cx-e.x,o=t.cy-e.y,u=1/Math.sqrt(s*s+o*o);if((i-n)*u<d){var a=t.charge*u*u;return e.px-=s*a,e.py-=o*a,!0}if(t.point&&isFinite(u)){var a=t.pointCharge*u*u;e.px-=s*a,e.py-=o*a}}return!t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,n.resume()}var n={},r=d3.dispatch("start","tick","end"),i=[1,1],s,o,a=.9,l=Zn,c=er,h=-30,p=.1,d=.8,v=[],m=[],g,y,b;return n.tick=function(){if((o*=.99)<.005)return r.end({type:"end",alpha:o=0}),!0;var t=v.length,n=m.length,s,u,f,l,c,d,w,E,S;for(u=0;u<n;++u){f=m[u],l=f.source,c=f.target,E=c.x-l.x,S=c.y-l.y;if(d=E*E+S*S)d=o*y[u]*((d=Math.sqrt(d))-g[u])/d,E*=d,S*=d,c.x-=E*(w=l.weight/(c.weight+l.weight)),c.y-=S*w,l.x+=E*(w=1-w),l.y+=S*w}if(w=o*p){E=i[0]/2,S=i[1]/2,u=-1;if(w)while(++u<t)f=v[u],f.x+=(E-f.x)*w,f.y+=(S-f.y)*w}if(h){Yn(s=d3.geom.quadtree(v),o,b),u=-1;while(++u<t)(f=v[u]).fixed||s.visit(e(f))}u=-1;while(++u<t)f=v[u],f.fixed?(f.x=f.px,f.y=f.py):(f.x-=(f.px-(f.px=f.x))*a,f.y-=(f.py-(f.py=f.y))*a);r.tick({type:"tick",alpha:o})},n.nodes=function(e){return arguments.length?(v=e,n):v},n.links=function(e){return arguments.length?(m=e,n):m},n.size=function(e){return arguments.length?(i=e,n):i},n.linkDistance=function(e){return arguments.length?(l=f(e),n):l},n.distance=n.linkDistance,n.linkStrength=function(e){return arguments.length?(c=f(e),n):c},n.friction=function(e){return arguments.length?(a=e,n):a},n.charge=function(e){return arguments.length?(h=typeof e=="function"?e:+e,n):h},n.gravity=function(e){return arguments.length?(p=e,n):p},n.theta=function(e){return arguments.length?(d=e,n):d},n.alpha=function(e){return arguments.length?(o?e>0?o=e:o=0:e>0&&(r.start({type:"start",alpha:o=e}),d3.timer(n.tick)),n):o},n.start=function(){function e(e,n){var i=t(r),s=-1,o=i.length,u;while(++s<o)if(!isNaN(u=i[s][e]))return u;return Math.random()*n}function t(){if(!p){p=[];for(s=0;s<o;++s)p[s]=[];for(s=0;s<u;++s){var e=m[s];p[e.source.index].push(e.target),p[e.target.index].push(e.source)}}return p[r]}var r,s,o=v.length,u=m.length,a=i[0],f=i[1],p,d;for(r=0;r<o;++r)(d=v[r]).index=r,d.weight=0;g=[],y=[];for(r=0;r<u;++r)d=m[r],typeof d.source=="number"&&(d.source=v[d.source]),typeof d.target=="number"&&(d.target=v[d.target]),g[r]=l.call(this,d,r),y[r]=c.call(this,d,r),++d.source.weight,++d.target.weight;for(r=0;r<o;++r)d=v[r],isNaN(d.x)&&(d.x=e("x",a)),isNaN(d.y)&&(d.y=e("y",f)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);b=[];if(typeof h=="function")for(r=0;r<o;++r)
    b[r]=+h.call(this,v[r],r);else for(r=0;r<o;++r)b[r]=h;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){s||(s=d3.behavior.drag().origin(u).on("dragstart",Jn).on("drag",t).on("dragend",Kn)),this.on("mouseover.force",Qn).on("mouseout.force",Gn).call(s)},d3.rebind(n,r,"on")},d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u)e(a=s[o],n,f=a.value*r,i),n+=f}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s)r=Math.max(r,t(n[i]))}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},hr(n,r)},d3.layout.pie=function(){function e(s){var o=s.map(function(n,r){return+t.call(e,n,r)}),u=+(typeof r=="function"?r.apply(this,arguments):r),a=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(o),f=d3.range(s.length);n!=null&&f.sort(n===Io?function(e,t){return o[t]-o[e]}:function(e,t){return n(s[e],s[t])});var l=[];return f.forEach(function(e){var t;l[e]={data:s[e],value:t=o[e],startAngle:u,endAngle:u+=t*a}}),l}var t=Number,n=Io,r=0,i=2*xs;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var Io={};d3.layout.stack=function(){function e(u,a){var f=u.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t){return t.map(function(t,n){return[s.call(e,t,n),o.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,d=f[0].length,v,m,g;for(m=0;m<d;++m){i.call(e,f[0][m],g=h[m],l[0][m][1]);for(v=1;v<p;++v)i.call(e,f[v][m],g+=l[v-1][m][1],l[v][m][1])}return u}var t=u,n=ir,r=sr,i=rr,s=tr,o=nr;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:qo.get(t)||ir,e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:Ro.get(t)||sr,e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(i=t,e):i},e};var qo=d3.map({"inside-out":function(e){var t=e.length,n,r,i=e.map(or),s=e.map(ur),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n)r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r));return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":ir}),Ro=d3.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i,s,o,u,a,f,l,c,h,p=[];p[0]=c=h=0;for(s=1;s<r;++s){for(i=0,u=0;i<t;++i)u+=e[i][s][1];for(i=0,a=0,l=n[s][0]-n[s-1][0];i<t;++i){for(o=0,f=(e[i][s][1]-e[i][s-1][1])/(2*l);o<i;++o)f+=(e[o][s][1]-e[o][s-1][1])/l;a+=f*e[i][s][1]}p[s]=c-=u?a/u*l:0,c<h&&(h=c)}for(s=0;s<r;++s)p[s]-=h;return p},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:sr});d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,d;while(++s<h)l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0;if(h>0){s=-1;while(++s<c)d=u[s],d>=a[0]&&d<=a[1]&&(l=o[d3.bisect(f,d,1,h)-1],l.y+=p,l.push(e[s]))}return o}var t=!0,n=Number,r=cr,i=fr;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=f(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return lr(e,t)}:f(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o),f=Uo?t:{data:t};f.depth=o,u.push(f);if(a&&(c=a.length)){var l=-1,c,h=f.children=[],p=0,d=o+1,v;while(++l<c)v=e(a[l],d,u),v.parent=f,h.push(v),p+=v.value;r&&h.sort(r),s&&(f.value=p)}else s&&(f.value=+s.call(n,t,o)||0);return f}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a)o+=t(i[u],f)}else s&&(o=+s.call(n,Uo?e:e.data,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=vr,i=pr,s=dr;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n};var Uo=!1;d3.layout.pack=function(){function e(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,jr(o,function(e){e.r=Math.sqrt(e.value)}),jr(o,Er);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;jr(o,function(e){e.r+=l}),jr(o,Er),jr(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return Tr(o,u/2,a/2,1/f),s}var t=d3.layout.hierarchy().sort(gr),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.padding=function(t){return arguments.length?(n=+t,e):n},hr(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0;jr(o,function(e){var t=e.children;t&&t.length?(e.x=kr(t),e.y=Cr(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var f=Lr(o),l=Ar(o),c=f.x-n(f,l)/2,h=l.x+n(l,f)/2;return jr(o,function(e){e.x=(e.x-c)/(h-c)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=Or,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},hr(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o)c=r[h],s(c,f),l=u(c,f,l),f=c;Fr(e);var p=.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)o(n[r],t)}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=_r(o),i=Mr(i),o&&i)u=Mr(u),s=_r(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(Ir(qr(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!_r(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!Mr(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];jr(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=Dr(f,Hr),c=Dr(f,Pr),h=Dr(f,Br),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return jr(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=Or,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},hr(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,d=p==="slice"?o.dx:p==="dice"||p==="slice-dice"&&n.depth&1?o.dy:Math.min(o.dx,o.dy),v;e(a,o.dx*o.dy/n.value),u.area=0;while((v=a.length)>0)u.push(f=a[v-1]),u.area+=f.area,p!=="squarify"||(h=r(u,d))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,d,o,!1),d=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity);u.length&&(i(u,d,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop())a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*d/n,n/(t*s*d)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy)f=n.dy;while(++i<s)l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=Math.min(n.x+n.dx-o,f?u(l.area/f):0);l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx)f=n.dx;while(++i<s)l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=Math.min(n.y+n.dy-a,f?u(l.area/f):0);l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=Rr,c=!1,h,p="squarify",d=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?Rr(t):Ur(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return Ur(t,e)}if(!arguments.length)return f;var r;return l=(f=e)==null?Rr:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(d=e,s):d},s.mode=function(e){return arguments.length?(p=e+"",s):p},hr(s,o)},d3.csv=zr(",","text/csv"),d3.tsv=zr("	","text/tab-separated-values"),d3.geo={};var zo={Feature:function(e){this.geometry(e.geometry)},FeatureCollection:function(e){var t=e.features,n=-1,r=t.length;while(++n<r)this.Feature(t[n])},GeometryCollection:function(e){var t=e.geometries,n=-1,r=t.length;while(++n<r)this.geometry(t[n])},LineString:function(e){this.line(e.coordinates)},MultiLineString:function(e){var t=e.coordinates,n=-1,r=t.length;while(++n<r)this.line(t[n])},MultiPoint:function(e){var t=e.coordinates,n=-1,r=t.length;while(++n<r)this.point(t[n])},MultiPolygon:function(e){var t=e.coordinates,n=-1,r=t.length;while(++n<r)this.polygon(t[n])},Point:function(e){this.point(e.coordinates)},Polygon:function(e){this.polygon(e.coordinates)},object:function(e){return Xo.hasOwnProperty(e.type)?this[e.type](e):this.geometry(e)},geometry:function(e){return Wo.hasOwnProperty(e.type)?this[e.type](e):null},point:jt,line:function(e){var t=-1,n=e.length;while(++t<n)this.point(e[t])},polygon:function(e){var t=-1,n=e.length;while(++t<n)this.line(e[t])}},Wo={LineString:1,MultiLineString:1,MultiPoint:1,MultiPolygon:1,Point:1,Polygon:1},Xo={Feature:1,FeatureCollection:1,GeometryCollection:1};d3.geo.albersUsa=function(){function e(e){return t(e)(e)}function t(e){var t=e[0],o=e[1];return o>50?r:t<-140?i:o<21?s:n}var n=d3.geo.albers(),r=d3.geo.albers().rotate([160,0]).center([0,60]).parallels([55,65]),i=d3.geo.albers().rotate([160,0]).center([0,20]).parallels([8,18]),s=d3.geo.albers().rotate([60,0]).center([0,10]).parallels([8,18]);return e.point=function(e,n){return t(e).point(e,n)},e.line=function(e,n){return t(e[0]).line(e,n)},e.polygon=function(e,n){return t(e[0][0]).polygon(e,n)},e.scale=function(t){return arguments.length?(n.scale(t),r.scale(t*.6),i.scale(t),s.scale(t*1.5),e.translate(n.translate())):n.scale()},e.translate=function(t){if(!arguments.length)return n.translate();var o=n.scale(),u=t[0],a=t[1];return n.translate(t),r.translate([u-.4*o,a+.17*o]),i.translate([u-.19*o,a+.2*o]),s.translate([u+.58*o,a+.43*o]),e},e.scale(n.scale())},(d3.geo.albers=function(){var e=29.5*Cs,t=45.5*Cs,n=wi(Xr),r=n(e,t);return r.parallels=function(r){return arguments.length?n(e=r[0]*Cs,t=r[1]*Cs):[e*ks,t*ks]},r.rotate([98,0]).center([0,38]).scale(1e3)}).raw=Xr;var Vo=Oi(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(d3.geo.azimuthalEqualArea=function(){return bi(Vo)}).raw=Vo;var $o=Oi(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},u);(d3.geo.azimuthalEquidistant=function(){return bi($o)}).raw=$o,d3.geo.bounds=Vr(u),d3.geo.circle=function(){function e(){var e=typeof t=="function"?t.apply(this,arguments):t;i=Ni(-e[0]*Cs,-e[1]*Cs,0);var n=[];return ai(s,{lineTo:function(e,t){var r=i.invert(e,t);r[0]*=ks,r[1]*=ks,n.push(r)}}),{type:"Polygon",coordinates:[n]}}var t=[0,0],n,r=6,i,s;return e.origin=function(n){return arguments.length?(t=n,e):t},e.angle=function(t){return arguments.length?(s=Jr((n=+t)*Cs,r*Cs),e):n},e.precision=function(t){return arguments.length?(s=Jr(radians,(r=+t)*Cs),e):r},e.angle(90)},(d3.geo.equirectangular=function(){return bi(li).scale(250/xs)}).raw=li.invert=li;var Jo=Oi(function(e){return 1/e},Math.atan);(d3.geo.gnomonic=function(){return bi(Jo)}).raw=Jo,d3.geo.graticule=function(){function e(){return{type:"GeometryCollection",geometries:e.lines()}}var t,n,r,i,s=22.5,o=s,u,a,f=2.5;return e.lines=function(){return d3.range(Math.ceil(n/s)*s,t,s).map(u).concat(d3.range(Math.ceil(i/o)*o,r,o).map(a)).map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[u(n).concat(a(r).slice(1),u(t).reverse().slice(1),a(i).reverse().slice(1))]}},e.extent=function(s){return arguments.length?(n=+s[0][0],t=+s[1][0],i=+s[0][1],r=+s[1][1],n>t&&(s=n,n=t,t=s),i>r&&(s=i,i=r,r=s),e.precision(f)):[[n,i],[t,r]]},e.step=function(t){return arguments.length?(s=+t[0],o=+t[1],e):[s,o]},e.precision=function(s){return arguments.length?(f=+s,u=ci(i,r,f),a=hi(n,t,f),e):f},e.extent([[-180+Ts,-90+Ts],[180-Ts,90-Ts]])},d3.geo.greatArc=function(){function e(){var t=e.distance.apply(this,arguments),n=0,r=u/t,s=[i];while((n+=r)<1)s.push(a(n));return s.push(o),{type:"LineString",coordinates:s}}var r=n,i,s=t,o,u=6*Cs,a=pi();return e.distance=function(){return typeof r=="function"&&a.source(i=r.apply(this,arguments)),typeof s=="function"&&a.target(o=s.apply(this,arguments)),a.distance()},e.source=function(t){return arguments.length?(r=t,typeof r!="function"&&a.source(i=r),e):r},e.target=function(t){return arguments.length?(s=t,typeof s!="function"&&a.target(o=s),e):s},e.precision=function(t){return arguments.length?(u=t*Cs,e):u/Cs},e},di.invert=function(e,t){return[2*xs*e,2*Math.atan(Math.exp(2*xs*t))-xs/2]},(d3.geo.mercator=function(){return bi(di).scale(500)}).raw=di;var Ko=Oi(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return bi(Ko)}).raw=Ko,d3.geo.path=function(){function t(e){var t=null;return e!=t&&(typeof u=="function"&&(a=vi(u.apply(this,arguments))),d.object(e),c.length&&(t=c.join(""),c=[])),t}function n(e){return Math.abs(d3.geom.polygon(e.map(f)).area())}function r(e){return n(e[0])-d3.sum(e.slice(1),n)}function i(e,t){return t=f(t),e[0]+=t[0],e[1]+=t[1],1}function s(e,t){if(!(n=t.length))return 0;var n,r=f(t[0]),i=r[0],s=r[1],o,u,a,l,c=0,h,p=0;while(++c<n)r=f(t[c]),o=r[0],u=r[1],a=o-i,l=u-s,p+=h=Math.sqrt(a*a+l*l),e[0]+=h*(i+o)/2,e[1]+=h*(s+u)/2,i=o,s=u;return p}function o(e,t,n){var r=d3.geom.polygon(t.map(f)),i=r.area(),s=r.centroid(i<0?(i*=-1,1):-1);return e[0]+=s[0],e[1]+=s[1],i*(n>0?-6:6)}var u=4.5,a=vi(u),f=d3.geo.albersUsa(),l,c=[],h={point:function(e,t){c.push("M",e,",",t,a)},moveTo:function(e,t){c.push("M",e,",",t)},lineTo:function(e,t){c.push("L",e,",",t)},closePath:function(){c.push("Z")}},p=h,d=Wr({line:function(e){f.line(e,p)},polygon:function(e){f.polygon(e,p)},point:function(e){f.point(e,p)}}),v=Wr({Feature:function(e){return v.geometry(e.geometry)},FeatureCollection:function(e){return d3.sum(e.features,v.Feature)},GeometryCollection:function(e){return d3.sum(e.geometries,v.geometry)},LineString:e,MultiLineString:e,MultiPoint:e,MultiPolygon:function(e){return d3.sum(e.coordinates,r)},Point:e,Polygon:function(e){return r(e.coordinates)}});t.area=function(e){return v.object(e)};var m=Wr({Feature:function(e){return m.geometry(e.geometry)},LineString:mi(s),MultiLineString:gi(s),MultiPoint:gi(i),MultiPolygon:yi(o),Point:mi(i),Polygon:gi(o)});return t.bounds=function(e){return(l||(l=Vr(f)))(e)},t.centroid=function(e){return m.object(e)},t.projection=function(e){return arguments.length?(f=e,l=null,t):f},t.context=function(e){return arguments.length?(p=e,p==null&&(p=h),t):p===h?null:p},t.pointRadius=function(e){return arguments.length?(typeof e=="function"?u=e:a=vi(u=+e),t):u},t},d3.geo.projection=bi,d3.geo.projectionMutator=wi,Ci.invert=function(e,t){return[e,t]};var Qo=Oi(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(d3.geo.stereographic=function(){return bi(Qo)}).raw=Qo,d3.geom={},d3.geom.hull=function(e){if(e.length<3)return[];var t=e.length,n=t-1,r=[],i=[],s,o,u=0,a,f,l,c,h,p,d,v;for(s=1;s<t;++s)e[s][1]<e[u][1]?u=s:e[s][1]==e[u][1]&&(u=e[s][0]<e[u][0]?s:u);for(s=0;s<t;++s){if(s===u)continue;f=e[s][1]-e[u][1],a=e[s][0]-e[u][0],r.push({angle:Math.atan2(f,a),index:s})}r.sort(function(e,t){return e.angle-t.angle}),d=r[0].angle,p=r[0].index,h=0;for(s=1;s<n;++s)o=r[s].index,d==r[s].angle?(a=e[p][0]-e[u][0],f=e[p][1]-e[u][1],l=e[o][0]-e[u][0],c=e[o][1]-e[u][1],a*a+f*f>=l*l+c*c?r[s].index=-1:(r[h].index=-1,d=r[s].angle,h=s,p=o)):(d=r[s].angle,h=s,p=o);i.push(u);for(s=0,o=0;s<2;++o)r[o].index!==-1&&(i.push(r[o].index),s++);v=i.length;for(;o<n;++o){if(r[o].index===-1)continue;while(!Mi(i[v-2],i[v-1],r[o].index,e))--v;i[v++]=r[o].index}var m=[];for(s=0;s<v;++s)m.push(e[i[s]]);return m},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n)r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return(i-r)*.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o)l=n[s],_i(l,u,a)?(_i(f,u,a)||t.push(Di(f,l,u,a)),t.push(l)):_i(f,u,a)&&t.push(Di(f,l,u,a)),f=l;u=a}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]}),n=1e6;return Pi(e,function(e){var r,i,s,o,u,a;e.a===1&&e.b>=0?(r=e.ep.r,i=e.ep.l):(r=e.ep.l,i=e.ep.r),e.a===1?(u=r?r.y:-n,s=e.c-e.b*u,a=i?i.y:n,o=e.c-e.b*a):(s=r?r.x:-n,u=e.c-e.a*s,o=i?i.x:n,a=e.c-e.a*o);var f=[s,u],l=[o,a];t[e.region.l.index].push(f,l),t[e.region.r.index].push(f,l)}),t=t.map(function(t,n){var r=e[n][0],i=e[n][1],s=t.map(function(e){return Math.atan2(e[0]-r,e[1]-i)});return d3.range(t.length).sort(function(e,t){return s[e]-s[t]}).filter(function(e,t,n){return!t||s[e]-s[n[t-1]]>Ts}).map(function(e){return t[e]})}),t.forEach(function(t,r){var i=t.length;if(!i)return t.push([-n,-n],[-n,n],[n,n],[n,-n]);if(i>2)return;var s=e[r],o=t[0],u=t[1],a=s[0],f=s[1],l=o[0],c=o[1],h=u[0],p=u[1],d=Math.abs(h-l),v=p-c;if(Math.abs(v)<Ts){var m=f<c?-n:n;t.push([-n,m],[n,m])}else if(d<Ts){var g=a<l?-n:n;t.push([g,-n],[g,n])}else{var m=(h-l)*(c-f)<(l-a)*(p-c)?n:-n,y=Math.abs(v)-d;Math.abs(y)<Ts?t.push([v<0?m:-m,m]):(y>0&&(m*=-1),t.push([-n,m],[n,m]))}}),t};var Go={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return Pi(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},d3.geom.quadtree=function(e,t,n,r,i){function s(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var u=e.point;u?Math.abs(u.x-t.x)+Math.abs(u.y-t.y)<.01?o(e,t,n,r,i,s):(e.point=null,o(e,u,n,r,i,s),o(e,t,n,r,i,s)):e.point=t}else o(e,t,n,r,i,s)}function o(e,t,n,r,i,o){var u=(n+i)*.5,a=(r+o)*.5,f=t.x>=u,l=t.y>=a,c=(l<<1)+f;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=Hi()),f?n=u:i=u,l?r=a:o=a,s(e,t,n,r,i,o)}var u,a=-1,f=e.length;if(arguments.length<5)if(arguments.length===3)i=n,r=t,n=t=0;else{t=n=Infinity,r=i=-Infinity;while(++a<f)u=e[a],u.x<t&&(t=u.x),u.y<n&&(n=u.y),u.x>r&&(r=u.x),u.y>i&&(i=u.y)}var l=r-t,c=i-n;l>c?i=n+l:r=t+c;var h=Hi();return h.add=function(e){s(h,e,t,n,r,i)},h.visit=function(e){Bi(e,h,t,n,r,i)},e.forEach(h.add),h},d3.time={};var Yo=Date,Zo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];ji.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){eu.setUTCDate.apply(this._,arguments)},setDay:function(){eu.setUTCDay.apply(this._,arguments)},setFullYear:function(){eu.setUTCFullYear.apply(this._,arguments)},setHours:function(){eu.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){eu.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){eu.setUTCMinutes.apply(this._,arguments)},setMonth:function(){eu.setUTCMonth.apply(this._,arguments)},setSeconds:function(){eu.setUTCSeconds.apply(this._,arguments)},setTime:function(){eu.setTime.apply(this._,arguments)}};var eu=Date.prototype,tu="%a %b %e %X %Y",nu="%m/%d/%Y",ru="%H:%M:%S",iu=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],su=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ou=["January","February","March","April","May","June","July","August","September","October","November","December"],uu=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];d3.time.format=function(e){function t(t){var r=[],i=-1,s=0,o,u,a;while(++i<n)if(e.charCodeAt(i)===37){r.push(e.substring(s,i)),(u=du[o=e.charAt(++i)])!=null&&(o=e.charAt(++i));if(a=vu[o])o=a(t,u==null?o==="e"?" ":"0":u);r.push(o),s=i+1}return r.push(e.substring(s,i)),r.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=Fi(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+n.p*12);var i=new Yo;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},t.toString=function(){return e},t};var au=Ii(iu),fu=Ii(su),lu=Ii(ou),cu=qi(ou),hu=Ii(uu),pu=qi(uu),du={"-":"",_:" ",0:"0"},vu={a:function(e){return su[e.getDay()]},A:function(e){return iu[e.getDay()]},b:function(e){return uu[e.getMonth()]},B:function(e){return ou[e.getMonth()]},c:d3.time.format(tu),d:function(e,t){return Ri(e.getDate(),t,2)},e:function(e,t){return Ri(e.getDate(),t,2)},H:function(e,t){return Ri(e.getHours(),t,2)},I:function(e,t){return Ri(e.getHours()%12||12,t,2)},j:function(e,t){return Ri(1+d3.time.dayOfYear(e),t,3)},L:function(e,t){return Ri(e.getMilliseconds(),t,3)},m:function(e,t){return Ri(e.getMonth()+1,t,2)},M:function(e,t){return Ri(e.getMinutes(),t,2)},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e,t){return Ri(e.getSeconds(),t,2)},U:function(e,t){return Ri(d3.time.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Ri(d3.time.mondayOfYear(e),t,2)},x:d3.time.format(nu),X:d3.time.format(ru),y:function(e,t){return Ri(e.getFullYear()%100,t,2)},Y:function(e,t){return Ri(e.getFullYear()%1e4,t,4)},Z:ss,"%":function(){return"%"}},mu={a:Ui,A:zi,b:Wi,B:Xi,c:Vi,d:Zi,e:Zi,H:es,I:es,L:rs,m:Yi,M:ts,p:is,S:ns,x:$i,X:Ji,y:Qi,Y:Ki},gu=/^\s*\d+/,yu=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{Yo=ji;var t=new Yo;return t._=e,n(t)}finally{Yo=Date}}var n=d3.time.format(e);return t.parse=function(e){try{Yo=ji;var t=n.parse(e);return t&&t._}finally{Yo=Date}},t.toString=n.toString,t};var bu=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?os:bu,os.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},os.toString=bu.toString,d3.time.second=us(function(e){return new Yo(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=us(function(e){return new Yo(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=us(function(e){var t=e.getTimezoneOffset()/60;return new Yo((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=us(function(e){var t=new Yo(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)},Zo.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var n=d3.time[e]=us(function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});d3.time[e+"s"]=n.range,d3.time[e+"s"].utc=n.utc.range,d3.time[e+"OfYear"]=function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=us(function(e){return e=d3.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=us(function(e){return e=d3.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var wu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Eu=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Su=[[d3.time.format("%Y"),a],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return e.getDate()!=1}],[d3.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],xu=d3.scale.linear(),Tu=hs(Su);Eu.year=function(e,t){return xu.domain(e.map(ds)).ticks(t).map(ps)},d3.time.scale=function(){return fs(d3.scale.linear(),Eu,Tu)};var Nu=Eu.map(function(e){return[e[0].utc,e[1]]}),Cu=[[d3.time.format.utc("%Y"),a],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],ku=hs(Cu);Nu.year=function(e,t){return xu.domain(e.map(ms)).ticks(t).map(vs)},d3.time.scale.utc=function(){return fs(d3.scale.linear(),Nu,ku)}})(),function(e,t){function n(e){if(e&&e.__wrapped__)return e;if(!(this instanceof n))return new n(e);this.__wrapped__=e}function r(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||tn);if(i){var s={},o=t-1;while(++o<r){var u=e[o]+"";(xn.call(s,u)?s[u]:s[u]=[]).push(e[o])}}return function(n){if(i){var r=n+"";return xn.call(s,r)&&ft(s[r],n)>-1}return ft(e,n,t)>-1}}function i(e){return e.charCodeAt(0)}function s(e,n){var r=e.index,i=n.index;e=e.criteria,n=n.criteria;if(e!==n){if(e>n||e===t)return 1;if(e<n||n===t)return-1}return r<i?-1:1}function o(e,t,n){function r(){var u=arguments,a=s?this:t;i||(e=t[o]),n.length&&(u=u.length?n.concat(Cn.call(u)):n);if(this instanceof r){c.prototype=e.prototype,a=new c;var f=e.apply(a,u);return k(f)?f:a}return e.apply(a,u)}var i=C(e),s=!n,o=e;return s&&(n=t),r}function u(e,n){return e?typeof e!="function"?function(t){return t[e]}:n!==t?function(t,r,i){return e.call(n,t,r,i)}:e:Bt}function a(){var e={arrayLoop:"",bottom:"",hasDontEnumBug:Xn,isKeysFast:tr,objectLoop:"",noArgsEnum:Jn,noCharByIndex:Gn,shadowed:gn,top:"",useHas:!0};for(var t,n=0;t=arguments[n];n++)for(var r in t)e[r]=t[r];var i=e.args;e.firstArg=/^[^,]+/.exec(i)[0];var s=Function("createCallback, hasOwnProperty, isArguments, isString, objectTypes, nativeKeys, propertyIsEnumerable","return function("+i+") {\n"+or(e)+"\n}");return s(u,xn,p,_,ir,_n,Nn)}function f(e){return"\\"+sr[e]}function l(e){return hr[e]}function c(){}function h(e){return pr[e]}function p(e){return kn.call(e)==Bn}function d(e){var t=!1;if(!e||typeof e!="object"||p(e))return t;var n=e.constructor;return(!Yn||typeof e.toString=="function"||typeof (e+"")!="string")&&(!C(n)||n instanceof n)?Vn?(lr(e,function(e,n,r){return t=!xn.call(r,n),!1}),t===!1):(lr(e,function(e,n){t=n}),t===!1||xn.call(e,t)):t}function v(e){var t=[];return cr(e,function(e,n){t.push(n)}),t}function m(e,t,n,r,i){if(e==null)return e;n&&(t=!1);var s=k(e);if(s){var o=kn.call(e);if(!rr[o]||Kn&&p(e))return e;var u=o==jn;s=u||(o==Un?gr(e):s)}if(!s||!t)return s?u?Cn.call(e):vr({},e):e;var a=e.constructor;switch(o){case Fn:case In:return new a(+e);case Rn:case Wn:return new a(e);case zn:return a(e.source,fn.exec(e))}r||(r=[]),i||(i=[]);var f=r.length;while(f--)if(r[f]==e)return i[f];var l=u?a(e.length):{};return r.push(e),i.push(l),(u?br:cr)(e,function(e,n){l[n]=m(e,t,null,r,i)}),l}function g(e){var t=[];return lr(e,function(e,n){C(e)&&t.push(n)}),t.sort()}function y(e,t){return e?xn.call(e,t):!1}function b(e){var t={};return cr(e,function(e,n){t[e]=n}),t}function w(e){return e===!0||e===!1||kn.call(e)==Fn}function E(e){return kn.call(e)==In}function S(e){return e?e.nodeType===1:!1}function x(e){var t=!0;if(!e)return t;var n=kn.call(e),r=e.length;return n==jn||n==Wn||n==Bn||Kn&&p(e)||n==Un&&typeof r=="number"&&C(e.splice)?!r:(cr(e,function(){return t=!1}),t)}function T(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;var i=kn.call(e);if(i!=kn.call(t))return!1;switch(i){case Fn:case In:return+e==+t;case Rn:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case zn:case Wn:return e==t+""}var s=i==jn||i==Bn;if(Kn&&!s&&(s=p(e))&&!p(t))return!1;if(!s){if(e.__wrapped__||t.__wrapped__)return T(e.__wrapped__||e,t.__wrapped__||t);if(i!=Un||Yn&&(typeof e.toString!="function"&&typeof (e+"")=="string"||typeof t.toString!="function"&&typeof (t+"")=="string"))return!1;var o=e.constructor,u=t.constructor;if(o!=u&&!(C(o)&&o instanceof o&&C(u)&&u instanceof u))return!1}n||(n=[]),r||(r=[]);var a=n.length;while(a--)if(n[a]==e)return r[a]==t;var f=-1,l=!0,c=0;n.push(e),r.push(t);if(s){c=e.length,l=c==t.length;if(l)while(c--)if(!(l=T(e[c],t[c],n,r)))break;return l}for(var h in e)if(xn.call(e,h)){c++;if(!xn.call(t,h)||!T(e[h],t[h],n,r))return!1}for(h in t)if(xn.call(t,h)&&!(c--))return!1;if(Xn)while(++f<7){h=gn[f];if(xn.call(e,h)&&(!xn.call(t,h)||!T(e[h],t[h],n,r)))return!1}return!0}function N(e){return On(e)&&!Mn(parseFloat(e))}function C(e){return typeof e=="function"}function k(e){return e?ir[typeof e]:!1}function L(e){return kn.call(e)==Rn&&e!=+e}function A(e){return e===null}function O(e){return kn.call(e)==Rn}function M(e){return kn.call(e)==zn}function _(e){return kn.call(e)==Wn}function D(e){return e===t}function P(e,t,n){var r=arguments,i=0,s=2,o=r[3],u=r[4];n!==Yt&&(o=[],u=[],s=r.length);while(++i<s)cr(r[i],function(t,n){var r,i,s;if(t&&((i=mr(t))||gr(t))){var a=o.length;while(a--){r=o[a]==t;if(r)break}r?e[n]=u[a]:(o.push(t),u.push(s=(s=e[n],i)?mr(s)?s:[]:gr(s)?s:{}),e[n]=P(s,t,Yt,o,u))}else t!=null&&(e[n]=t)});return e}function H(e,t,n){var r=typeof t=="function",i={};if(r)t=u(t,n);else var s=wn.apply(Gt,arguments);return lr(e,function(e,n,o){if(r?!t(e,n,o):ft(s,n,1)<0)i[n]=e}),i}function B(e){var t=[];return cr(e,function(e,n){t.push([n,e])}),t}function j(e,t,n){var r={};if(typeof t!="function"){var i=0,s=wn.apply(Gt,arguments),o=s.length;while(++i<o){var a=s[i];a in e&&(r[a]=e[a])}}else t=u(t,n),lr(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function F(e){var t=[];return cr
(e,function(e){t.push(e)}),t}function I(e,t,n){var r=-1,i=e?e.length:0;return n=(n<0?Dn(0,i+n):n)||0,typeof i=="number"?(_(e)?e.indexOf(t,n):ft(e,t,n))>-1:tt(e,function(e){return++r>=n&&e===t})}function q(e,t,n){var r={};return t=u(t,n),br(e,function(e,n,i){n=t(e,n,i),xn.call(r,n)?r[n]++:r[n]=1}),r}function R(e,t,n){var r=!0;t=u(t,n);if(mr(e)){var i=-1,s=e.length;while(++i<s)if(!(r=!!t(e[i],i,e)))break}else br(e,function(e,n,i){return r=!!t(e,n,i)});return r}function U(e,t,n){var r=[];return t=u(t,n),br(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}function z(e,t,n){var r;return t=u(t,n),br(e,function(e,n,i){if(t(e,n,i))return r=e,!1}),r}function W(e,t,n){var r={};return t=u(t,n),br(e,function(e,n,i){n=t(e,n,i),(xn.call(r,n)?r[n]:r[n]=[]).push(e)}),r}function X(e,t){var n=Cn.call(arguments,2),r=typeof t=="function",i=[];return br(e,function(e){i.push((r?t:e[t]).apply(e,n))}),i}function V(e,t,n){var r=-1,i=e?e.length:0,s=Array(typeof i=="number"?i:0);t=u(t,n);if(mr(e))while(++r<i)s[r]=t(e[r],r,e);else br(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function $(e,t,n){var r=-Infinity,s=-1,o=e?e.length:0,a=r;if(t||!mr(e))t=!t&&_(e)?i:u(t,n),br(e,function(e,n,i){var s=t(e,n,i);s>r&&(r=s,a=e)});else while(++s<o)e[s]>a&&(a=e[s]);return a}function J(e,t,n){var r=Infinity,s=-1,o=e?e.length:0,a=r;if(t||!mr(e))t=!t&&_(e)?i:u(t,n),br(e,function(e,n,i){var s=t(e,n,i);s<r&&(r=s,a=e)});else while(++s<o)e[s]<a&&(a=e[s]);return a}function K(e,t){var n=[];return br(e,function(e){n.push(e[t])}),n}function Q(e,t,n,r){var i=arguments.length<3;return t=u(t,r),br(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function G(e,t,n,r){var i=e,s=e?e.length:0,o=arguments.length<3;if(typeof s!="number"){var u=yr(e);s=u.length}else Gn&&_(e)&&(i=e.split(""));return br(e,function(e,a,f){a=u?u[--s]:--s,n=o?(o=!1,i[a]):t.call(r,n,i[a],a,f)}),n}function Y(e,t,n){return t=u(t,n),U(e,function(e,n,r){return!t(e,n,r)})}function Z(e){var t=-1,n=Array(e?e.length:0);return br(e,function(e){var r=En(Hn()*(++t+1));n[t]=n[r],n[r]=e}),n}function et(e){var t=e?e.length:0;return typeof t=="number"?t:yr(e).length}function tt(e,t,n){var r;t=u(t,n);if(mr(e)){var i=-1,s=e.length;while(++i<s)if(r=t(e[i],i,e))break}else br(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function nt(e,t,n){var r=[];t=u(t,n),br(e,function(e,n,i){r.push({criteria:t(e,n,i),index:n,value:e})});var i=r.length;r.sort(s);while(i--)r[i]=r[i].value;return r}function rt(e){return e&&typeof e.length=="number"?(Qn?_(e):typeof e=="string")?e.split(""):Cn.call(e):F(e)}function it(e,t){var n=[];return lr(t,function(e,t){n.push(t)}),U(e,function(e){var r=n.length;while(r--){var i=e[n[r]]===t[n[r]];if(!i)break}return!!i})}function st(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function ot(e){var t=-1,n=e?e.length:0,i=wn.apply(Gt,arguments),s=r(i,n),o=[];while(++t<n){var u=e[t];s(u)||o.push(u)}return o}function ut(e,t,n){if(e)return t==null||n?e[0]:Cn.call(e,0,t)}function at(e,t){var n=-1,r=e?e.length:0,i=[];while(++n<r){var s=e[n];mr(s)?Tn.apply(i,t?s:at(s)):i.push(s)}return i}function ft(e,t,n){var r=-1,i=e?e.length:0;if(typeof n=="number")r=(n<0?Dn(0,i+n):n||0)-1;else if(n)return r=gt(e,t),e[r]===t?r:-1;while(++r<i)if(e[r]===t)return r;return-1}function lt(e,t,n){return e?Cn.call(e,0,-(t==null||n?1:t)):[]}function ct(e){var t=arguments,n=t.length,i={},s=[];return br(e,function(e){if(ft(s,e)<0){var o=n;while(--o)if(!(i[o]||(i[o]=r(t[o])))(e))return;s.push(e)}}),s}function ht(e,t,n){if(e){var r=e.length;return t==null||n?e[r-1]:Cn.call(e,-t||r)}}function pt(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?Dn(0,r+n):Pn(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function dt(e,t){var n=-1,r=e?e.length:0,i={};while(++n<r){var s=e[n];t?i[s]=t[n]:i[s[0]]=s[1]}return i}function vt(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=Dn(0,bn((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function mt(e,t,n){return e?Cn.call(e,t==null||n?1:t):[]}function gt(e,t,n,r){var i=0,s=e?e.length:i;n=n?u(n,r):Bt,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function yt(){return bt(wn.apply(Gt,arguments))}function bt(e,t,n,r){var i=-1,s=e?e.length:0,o=[],a=o;typeof t=="function"&&(r=n,n=t,t=!1);var f=!t&&s>74;if(f)var l={};n&&(a=[],n=u(n,r));while(++i<s){var c=e[i],h=n?n(c,i,e):c;f&&(a=xn.call(l,h+"")?l[h]:l[h]=[]);if(t?!i||a[a.length-1]!==h:ft(a,h)<0)(n||f)&&a.push(h),o.push(c)}return o}function wt(e){var t=-1,n=e?e.length:0,i=r(arguments,1,20),s=[];while(++t<n){var o=e[t];i(o)||s.push(o)}return s}function Et(e){var t=-1,n=e?$(K(arguments,"length")):0,r=Array(n);while(++t<n)r[t]=K(arguments,t);return r}function St(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function xt(e,t){return er||Ln&&arguments.length>2?Ln.call.apply(Ln,arguments):o(e,t,Cn.call(arguments,2))}function Tt(e){var t=arguments,n=t.length>1?0:(t=g(e),-1),r=t.length;while(++n<r){var i=t[n];e[i]=xt(e[i],e)}return e}function Nt(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function Ct(e,t,n){function r(){u=null,n||(s=e.apply(o,i))}var i,s,o,u;return function(){var a=n&&!u;return i=arguments,o=this,clearTimeout(u),u=setTimeout(r,t),a&&(s=e.apply(o,i)),s}}function kt(e,n){var r=Cn.call(arguments,2);return setTimeout(function(){e.apply(t,r)},n)}function Lt(e){var n=Cn.call(arguments,1);return setTimeout(function(){e.apply(t,n)},1)}function At(e,t){return o(t,e,Cn.call(arguments,2))}function Ot(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return xn.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function Mt(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function _t(e){return o(e,Cn.call(arguments,1))}function Dt(e,t){function n(){u=new Date,o=null,i=e.apply(s,r)}var r,i,s,o,u=0;return function(){var a=new Date,f=t-(a-u);return r=arguments,s=this,f<=0?(clearTimeout(o),u=a,i=e.apply(s,r)):o||(o=setTimeout(n,f)),i}}function Pt(e,t){return function(){var n=[e];return Tn.apply(n,arguments),t.apply(this,n)}}function Ht(e){return e==null?"":(e+"").replace(vn,l)}function Bt(e){return e}function jt(e){br(g(e),function(t){var r=n[t]=e[t];n.prototype[t]=function(){var e=[this.__wrapped__];Tn.apply(e,arguments);var t=r.apply(n,e);return this.__chain__&&(t=new n(t),t.__chain__=!0),t}})}function Ft(){return e._=nn,this}function It(e,t){return e==null&&t==null&&(t=1),e=+e||0,t==null&&(t=e,e=0),e+En(Hn()*((+t||0)-e+1))}function qt(e,t){var n=e?e[t]:null;return C(n)?e[t]():n}function Rt(e,t,r){e||(e=""),r||(r={});var i,s,o=n.templateSettings,u=0,a=r.interpolate||o.interpolate||dn,l="__p += '",c=r.variable||o.variable,h=c,p=RegExp((r.escape||o.escape||dn).source+"|"+a.source+"|"+(a===pn?hn:dn).source+"|"+(r.evaluate||o.evaluate||dn).source+"|$","g");e.replace(p,function(t,n,r,s,o,a){r||(r=s),l+=e.slice(u,a).replace(mn,f),l+=n?"' +\n__e("+n+") +\n'":o?"';\n"+o+";\n__p += '":r?"' +\n((__t = ("+r+")) == null ? '' : __t) +\n'":"",i||(i=o||rn.test(n||r)),u=a+t.length}),l+="';\n";if(!h){c="obj";if(i)l="with ("+c+") {\n"+l+"\n}\n";else{var d=RegExp("(\\(\\s*)"+c+"\\."+c+"\\b","g");l=l.replace(ln,"$&"+c+".").replace(d,"$1__d")}}l=(i?l.replace(on,""):l).replace(un,"$1").replace(an,"$1;"),l="function("+c+") {\n"+(h?"":c+" || ("+c+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(h?"":", __d = "+c+"."+c+" || "+c)+";\n")+l+"return __p\n}";var v=nr?"\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+yn++ +"]"):"";try{s=Function("_","return "+l+v)(n)}catch(m){throw m.source=l,m}return t?s(t):(s.source=l,s)}function Ut(e,t,n){e=+e||0;var r=-1,i=Array(e);while(++r<e)i[r]=t.call(n,r);return i}function zt(e){return e==null?"":(e+"").replace(sn,h)}function Wt(e){var t=Zt++;return e?e+t:t}function Xt(e){return e=new n(e),e.__chain__=!0,e}function Vt(e,t){return t(e),e}function $t(){return this.__chain__=!0,this}function Jt(){return this.__wrapped__}var Kt=typeof exports=="object"&&exports,Qt=typeof global=="object"&&global;Qt.global===Qt&&(e=Qt);var Gt=[],Yt=new function(){},Zt=0,en=Yt,tn=30,nn=e._,rn=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,sn=/&(?:amp|lt|gt|quot|#x27);/g,on=/\b__p \+= '';/g,un=/\b(__p \+=) '' \+/g,an=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fn=/\w*$/,ln=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,cn=RegExp("^"+(Yt.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),hn=/\$\{((?:(?=\\?)\\?[\s\S])*?)}/g,pn=/<%=([\s\S]+?)%>/g,dn=/($^)/,vn=/[&<>"']/g,mn=/['\n\r\t\u2028\u2029\\]/g,gn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],yn=0,bn=Math.ceil,wn=Gt.concat,En=Math.floor,Sn=cn.test(Sn=Object.getPrototypeOf)&&Sn,xn=Yt.hasOwnProperty,Tn=Gt.push,Nn=Yt.propertyIsEnumerable,Cn=Gt.slice,kn=Yt.toString,Ln=cn.test(Ln=Cn.bind)&&Ln,An=cn.test(An=Array.isArray)&&An,On=e.isFinite,Mn=e.isNaN,_n=cn.test(_n=Object.keys)&&_n,Dn=Math.max,Pn=Math.min,Hn=Math.random,Bn="[object Arguments]",jn="[object Array]",Fn="[object Boolean]",In="[object Date]",qn="[object Function]",Rn="[object Number]",Un="[object Object]",zn="[object RegExp]",Wn="[object String]",Xn,Vn,$n=($n={0:1,length:1},Gt.splice.call($n,0,1),$n[0]),Jn=!0;(function(){function e(){this.x=1}var t=[];e.prototype={valueOf:1,y:1};for(var n in new e)t.push(n);for(n in arguments)Jn=!n;Xn=!/valueOf/.test(t),Vn=t[0]!="x"})(1);var Kn=!p(arguments),Qn=Cn.call("x")[0]!="x",Gn="x"[0]+Object("x")[0]!="xx";try{var Yn=({toString:0}+"",kn.call(e.document||0)==Un)}catch(Zn){}var er=Ln&&/\n|Opera/.test(Ln+kn.call(e.opera)),tr=_n&&/^.+$|true/.test(_n+!!e.attachEvent);try{var nr=(Function("//@")(),!e.attachEvent)}catch(Zn){}var rr={};rr[Bn]=rr[qn]=!1,rr[jn]=rr[Fn]=rr[In]=rr[Rn]=rr[Un]=rr[zn]=rr[Wn]=!0;var ir={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},sr={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:pn,variable:""};var or=Rt("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (isString(iteratee)) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),ur={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},ar={useHas:!1,args:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",objectLoop:"result[index] = value",bottom:"  }\n}"},fr={arrayLoop:null};Kn&&(p=function(e){return e?xn.call(e,"callee"):!1});var lr=a(ur,fr,{useHas:!1}),cr=a(ur,fr),hr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},pr=b(hr),dr=a(ar,{objectLoop:"if (result[index] == null) "+ar.objectLoop}),vr=a(ar),mr=An||function(e){return kn.call(e)==jn};C(/x/)&&(C=function(e){return kn.call(e)==qn});var gr=Sn?function(e){if(!e||typeof e!="object")return!1;var t=e.valueOf,n=typeof t=="function"&&(n=Sn(t))&&Sn(n);return n?e==n||Sn(e)==n&&!p(e):d(e)}:d,yr=_n?function(e){return typeof e=="function"&&Nn.call(e,"prototype")?v(e):k(e)?_n(e):[]}:v,br=a(ur);n.VERSION="0.9.2",n.after=St,n.bind=xt,n.bindAll=Tt,n.chain=Xt,n.clone=m,n.compact=st,n.compose=Nt,n.contains=I,n.countBy=q,n.debounce=Ct,n.defaults=dr,n.defer=Lt,n.delay=kt,n.difference=ot,n.escape=Ht,n.every=R,n.extend=vr,n.filter=U,n.find=z,n.first=ut,n.flatten=at,n.forEach=br,n.forIn=lr,n.forOwn=cr,n.functions=g,n.groupBy=W,n.has=y,n.identity=Bt,n.indexOf=ft,n.initial=lt,n.intersection=ct,n.invert=b,n.invoke=X,n.isArguments=p,n.isArray=mr,n.isBoolean=w,n.isDate=E,n.isElement=S,n.isEmpty=x,n.isEqual=T,n.isFinite=N,n.isFunction=C,n.isNaN=L,n.isNull=A,n.isNumber=O,n.isObject=k,n.isPlainObject=gr,n.isRegExp=M,n.isString=_,n.isUndefined=D,n.keys=yr,n.last=ht,n.lastIndexOf=pt,n.lateBind=At,n.map=V,n.max=$,n.memoize=Ot,n.merge=P,n.min=J,n.mixin=jt,n.noConflict=Ft,n.object=dt,n.omit=H,n.once=Mt,n.pairs=B,n.partial=_t,n.pick=j,n.pluck=K,n.random=It,n.range=vt,n.reduce=Q,n.reduceRight=G,n.reject=Y,n.rest=mt,n.result=qt,n.shuffle=Z,n.size=et,n.some=tt,n.sortBy=nt,n.sortedIndex=gt,n.tap=Vt,n.template=Rt,n.throttle=Dt,n.times=Ut,n.toArray=rt,n.unescape=zt,n.union=yt,n.uniq=bt,n.uniqueId=Wt,n.values=F,n.where=it,n.without=wt,n.wrap=Pt,n.zip=Et,n.all=R,n.any=tt,n.collect=V,n.detect=z,n.drop=mt,n.each=br,n.foldl=Q,n.foldr=G,n.head=ut,n.include=I,n.inject=Q,n.methods=g,n.select=U,n.tail=mt,n.take=ut,n.unique=bt,n._iteratorTemplate=or,jt(n),n.prototype.chain=$t,n.prototype.value=Jt,br(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Gt[e];n.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),$n&&e.length===0&&delete e[0],this.__chain__&&(e=new n(e),e.__chain__=!0),e}}),br(["concat","join","slice"],function(e){var t=Gt[e];n.prototype[e]=function(){var e=this.__wrapped__,r=t.apply(e,arguments);return this.__chain__&&(r=new n(r),r.__chain__=!0),r}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=n,define(function(){return n})):Kt?typeof module=="object"&&module&&module.exports==Kt?(module.exports=n)._=n:Kt._=n:e._=n}(this),function(e){var t={};t.qsString=function(e){return Object.keys(e).sort().map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},t.sha=sha1(),t.stringQs=function(e){return e.split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=null===n[1]?"":decodeURIComponent(n[1]),e},{})},t.xhr=function(e,n,r,i,s,o){var u=new XMLHttpRequest;u.onreadystatechange=function(){4==u.readyState&&0!==u.status&&o(u)};var a=s&&s.header||{"Content-Type":"application/x-www-form-urlencoded"};u.open(e,n,!0),u.setRequestHeader("Authorization","OAuth "+t.authHeader(r));for(var f in a)u.setRequestHeader(f,a[f]);u.send(i)},t.nonce=function(){for(var e="";e.length<6;)e+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz"[Math.floor(Math.random()*61)];return e},t.authHeader=function(e){return Object.keys(e).sort().map(function(t){return encodeURIComponent(t)+'="'+encodeURIComponent(e[t])+'"'}).join(", ")},t.timestamp=function(){return~~(+(new Date)/1e3)},t.percentEncode=function(e){return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29")},t.baseString=function(e,n,r){return r.oauth_signature&&delete r.oauth_signature,[e,t.percentEncode(n),t.percentEncode(t.qsString(r))].join("&")},t.signature=function(e,n,r){return t.sha.b64_hmac_sha1(t.percentEncode(e)+"&"+t.percentEncode(n),r)},e.ohauth=t}(this);const JXON=new function(){function e(e){return f.test(e)?null:l.test(e)?e.toLowerCase()==="true":isFinite(e)?parseFloat(e):isFinite(Date.parse(e))?new Date(e):e}function t(){}function n(e){return e===null?new t:e instanceof Object?e:new e.constructor(e)}function r(t,i,f,l){const c=a.length,h=t.hasChildNodes(),p=t.hasAttributes(),d=Boolean(i&2);var v,m,g=0,y="",b=d?{}:!0;if(h)for(var w,E=0;E<t.childNodes.length;E++)w=t.childNodes.item(E),w.nodeType===4?y+=w.nodeValue:w.nodeType===3?y+=w.nodeValue.trim():w.nodeType===1&&!w.prefix&&a.push(w);const S=a.length,x=e(y);!d&&(h||p)&&(b=i===0?n(x):{});for(var T=c;T<S;T++)v=a[T].nodeName.toLowerCase(),m=r(a[T],i,f,l),b.hasOwnProperty(v)?(b[v].constructor!==Array&&(b[v]=[b[v]]),b[v].push(m)):(b[v]=m,g++);if(p){const N=t.attributes.length,C=l?"":u,k=l?{}:b;for(var L,A=0;A<N;g++,A++)L=t.attributes.item(A),k[C+L.name.toLowerCase()]=e(L.value.trim());l&&(f&&Object.freeze(k),b[o]=k,g-=N-1)}return i===3||(i===2||i===1&&g>0)&&y?b[s]=x:!d&&g===0&&y&&(b=x),f&&(d||g>0)&&Object.freeze(b),a.length=c,b}function i(e,t,n){var r,a;n instanceof String||n instanceof Number||n instanceof Boolean?t.appendChild(e.createTextNode(n.toString())):n.constructor===Date&&t.appendChild(e.createTextNode(n.toGMTString()));for(var f in n){r=n[f];if(isFinite(f)||r instanceof Function)continue;if(f===s)r!==null&&r!==!0&&t.appendChild(e.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if(f===o)for(var l in r)t.setAttribute(l,r[l]);else if(f.charAt(0)===u)t.setAttribute(f.slice(1),r);else if(r.constructor===Array)for(var c=0;c<r.length;c++)a=e.createElement(f),i(e,a,r[c]),t.appendChild(a);else a=e.createElement(f),r instanceof Object?i(e,a,r):r!==null&&r!==!0&&a.appendChild(e.createTextNode(r.toString())),t.appendChild(a)}}const s="keyValue",o="keyAttributes",u="@",a=[],f=/^\s*$/,l=/^(?:true|false)$/i;t.prototype.toString=function(){return"null"},t.prototype.valueOf=function(){return null},this.build=function(e,t,n,i){const s=arguments.length>1&&typeof t=="number"?t&3:1;return r(e,s,n||!1,arguments.length>3?i:s===3)},this.unbuild=function(e){const t=document.implementation.createDocument("","",null);return i(t,t,e),t}};var iD=function(e){if(!iD.supported()){e.innerHTML="This editor is supported in Firefox, Chrome, Safari, Opera, and Internet Explorer 9 and above. Please upgrade your browser or use Potlatch 2 to edit the map.",e.style.cssText="text-align:center;font-style:italic;";return}e=d3.select(e);var t=e.append("div").attr("id","map"),n=iD.Connection().url("http://api06.dev.openstreetmap.org"),r=iD.Map(t.node(),n),i=iD.Controller(r),s=e.append("div").attr("id","bar"),o=s.selectAll("button.add-button").data([iD.modes.AddPlace,iD.modes.AddRoad,iD.modes.AddArea]).enter().append("button").attr("class","add-button").text(function(e){return e.title}).on("click",function(e){i.enter(e)});i.on("enter",function(e){o.classed("active",function(t){return e===t})}),s.append("button").attr({id:"undo","class":"mini"}).property("disabled",!0).html("&larr;<small></small>").on("click",r.undo),s.append("button").attr({id:"redo","class":"mini"}).property("disabled",!0).html("&rarr;<small></small>").on("click",r.redo),s.append("input").attr({type:"text",placeholder:"find a place",id:"geocode-location"}).on("keydown",function(){if(d3.event.keyCode!==13)return;d3.event.preventDefault();var e=d3.select("#geocode-location").node().value;d3.select(document.body).append("script").attr("src","http://api.tiles.mapbox.com/v3/mapbox/geocode/"+encodeURIComponent(e)+".jsonp?callback=grid")}),window.grid=function(e){r.setCenter([e.results[0][0].lon,e.results[0][0].lat])},s.append("div").attr("class","messages"),s.append("div").attr("class","user").append("div").attr("class","hello"),s.append("button").attr("class","save").html("Upload<small id='as-username'></small>").on("click",function(){function e(e){d3.select(".shaded").remove();var t=iD.loading("uploading changes to openstreetmap");n.putChangeset(r.history.changes(),e.comment,function(){t.remove(),r.history=iD.History(),r.flush(),r.update(),r.redraw()})}n.authenticate(function(){shaded=d3.select(document.body).append("div").attr("class","shaded").on("click",function(){d3.event.target==this&&shaded.remove()});var t=shaded.append("div").attr("class","modal commit-pane").datum(r.history.changes());t.call(iD.commit().on("cancel",function(){shaded.remove()}).on("save",e))})});var u=s.append("div").attr("class","zoombuttons").selectAll("button").data([["zoom-in","+",r.zoomIn],["zoom-out","-",r.zoomOut]]).enter().append("button").attr("class",function(e){return e[0]}).text(function(e){return e[1]}).on("click",function(e){return e[2]()});e.append("div").attr("class","inspector-wrap").style("display","none"),e.append("div").attr("id","about").html("<p>Work in progress: <a href='http://www.geowiki.com/'>introduction</a>,<a href='http://github.com/systemed/iD'>code</a>,<a href='http://www.geowiki.com/docs'>docs</a>.Imagery <a href='http://opengeodata.org/microsoft-imagery-details'>&copy; 2012</a> Bing, GeoEye, Getmapping, Intermap, Microsoft.</p>"),r.on("update",function(){var e=r.history.undoAnnotation(),t=r.history.redoAnnotation();s.select("#undo").property("disabled",!e).select("small").text(e),s.select("#redo").property("disabled",!t).select("small").text(t)}),window.onresize=function(){r.size(t.size())},d3.select(document).on("keydown",function(){d3.event.which===90&&d3.event.metaKey&&r.undo(),d3.event.which===90&&d3.event.metaKey&&d3.event.shiftKey&&r.redo()});var a=iD.Hash().map(r);return a.hadHash||r.setZoom(20).center([-77.02405,38.87952]),d3.select(".user").call(iD.userpanel(n).on("logout",n.logout).on("login",n.authenticate)),r};iD.supported=function(){if(navigator.appName!=="Microsoft Internet Explorer")return!0;var e=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");return t.exec(e)!==null&&(rv=parseFloat(RegExp.$1)),rv&&rv<9?!1:!0},iD.OAuth=function(){function e(e){return e.replace(/\W/g,"")}function t(e){return e.oauth_timestamp=ohauth.timestamp(),e.oauth_nonce=ohauth.nonce(),e}function n(t,n){return arguments.length==2&&(localStorage[e(i)+t]=n),localStorage[e(i)+t]}var r="http://api06.dev.openstreetmap.org",i="http://api06.dev.openstreetmap.org",s="aMnOOCwExO2XYtRVWJ1bI9QOdqh1cay2UgpbhA6p",o={},u={oauth_consumer_key:"zwQZFivccHkLs3a8Rq5CoS412fE5aPCXDw9DZj7R",oauth_signature_method:"HMAC-SHA1"};return n("oauth_token")&&(u.oauth_token=n("oauth_token")),o.authenticated=function(){return n("oauth_token")&&n("oauth_token_secret")},o.logout=function(){return n("oauth_token",""),n("oauth_token_secret",""),n("oauth_request_token_secret",""),o},o.xhr=function(e,r){n("oauth_token")&&(u.oauth_token=n("oauth_token")),u=t(u);var o=i+e.path,a=n("oauth_token_secret");u.oauth_signature=ohauth.signature(s,a,ohauth.baseString(e.method,o,u)),ohauth.xhr(e.method,o,u,e.content,e.options,function(e){e.responseXML?r(e.responseXML):r(e.response)})},o.authenticate=function(e){if(o.authenticated())return e();o.logout();var i=d3.select(document.body).append("div").attr("class","shaded").on("click",function(){d3.event.target==this&&i.remove()}),a=i.append("div").attr("class","modal").style("display","none"),f=a.append("iframe").attr({width:640,height:550,frameborder:"no"});u=t(u);var l=r+"/oauth/request_token";u.oauth_signature=ohauth.signature(s,"",ohauth.baseString("POST",l,u));var c=iD.loading("contacting openstreetmap...");ohauth.xhr("POST",l,u,null,{},function(e){c.remove(),a.style("display","block");var t=ohauth.stringQs(e.response);n("oauth_request_token_secret",t.oauth_token_secret);var i=r+"/oauth/authorize?";f.attr("src",i+ohauth.qsString({oauth_token:t.oauth_token,oauth_callback:location.href}))}),f.on("load",function(){if(f.node().contentWindow.location.search){var o=f.node().contentWindow.location.search,a=ohauth.stringQs(o.slice(1)),l=r+"/oauth/access_token";u=t(u),i.remove(),u.oauth_token=a.oauth_token;var c=n("oauth_request_token_secret");u.oauth_signature=ohauth.signature(s,c,ohauth.baseString("POST",l,u));var h=iD.loading("contacting openstreetmap...");ohauth.xhr("POST",l,u,null,{},function(t){h.remove();var r=ohauth.stringQs(t.response);n("oauth_token",r.oauth_token),n("oauth_token_secret",r.oauth_token_secret),e()})}})},o.setAPI=function(e){return i=e,o},o},iD.Connection=function(){function e(e,n){t(h+"/api/0.6/map?bbox="+[e[0][0],e[1][1],e[1][0],e[0][1]],n)}function t(e,t){d3.xml(e,function(e,n){t(o(n))})}function n(e){var t=[],n=e.getElementsByTagName("nd");for(var r=0,i=n.length;r<i;r++)t[r]="n"+n[r].attributes.ref.nodeValue,d["n"+n[r].attributes.ref.nodeValue]=!0;return t}function r(e){var t={},n=e.getElementsByTagName("tag");for(var r=0,i=n.length;r<i;r++){var s=n[r];t[s.attributes.k.nodeValue]=s.attributes.v.nodeValue}return t}function i(e){var t=[],n=e.getElementsByTagName("member");for(var r=0,i=n.length;r<i;r++)t[r]={id:n[r].attributes.type.nodeValue[0]+n[r].attributes.ref.nodeValue,type:n[r].attributes.type.nodeValue,role:n[r].attributes.role.nodeValue};return t}function s(e){var t={type:e.nodeName,members:i(e),nodes:n(e),tags:r(e)};for(var s=0,o=e.attributes.length;s<o;s++){var u=e.attributes[s].nodeName,a=e.attributes[s].nodeValue;t[u]=a}return t.lat&&(t.lat=parseFloat(t.lat)),t.lon&&(t.lon=parseFloat(t.lon)),t._id=t.id,t.id=t.type[0]+t.id,iD.Entity(t)}function o(e){function t(e){var t=s(e);t.type==="node"&&(t._poi=!d[t.id]),r[t.id]=t}if(!e.childNodes)return new Error("Bad request");var n=e.childNodes[0],r={};return d={},_.forEach(n.getElementsByTagName("way"),t),_.forEach(n.getElementsByTagName("node"),t),_.forEach(n.getElementsByTagName("relation"),t),iD.Graph(r)}function u(e){return m.authenticate(function(){c.auth(),e&&e()})}function a(){return m.authenticated()}function f(e,t,n){m.xhr({method:"PUT",path:"/api/0.6/changeset/create",options:{header:{"Content-Type":"text/xml"}},content:iD.format.XML.changeset(t)},function(t){m.xhr({method:"POST",path:"/api/0.6/changeset/"+t+"/upload",options:{header:{"Content-Type":"text/xml"}},content:iD.format.XML.osmChange(v.id,t,e)},function(){m.xhr({method:"PUT",path:"/api/0.6/changeset/"+t+"/close"},function(){n(t)})})})}function l(e){m.xhr({method:"GET",path:"/api/0.6/user/details"},function(t){var n=t.getElementsByTagName("user")[0];e(p.user({display_name:n.attributes.display_name.nodeValue,id:n.attributes.id.nodeValue}).user())})}var c=d3.dispatch("auth"),h="http://www.openstreetmap.org",p={},d={},v={},m=iD.OAuth().setAPI(h);return p.url=function(e){return arguments.length?(h=e,m.setAPI(e),p):h},p.user=function(e){return arguments.length?(v=e,p):v},p.logout=function(){return m.logout(),c.auth(),p},p.bboxFromAPI=e,p.loadFromURL=t,p.userDetails=l,p.authenticate=u,p.authenticated=a,p.putChangeset=f,p.objectData=s,p.apiURL=h,d3.rebind(p,c,"on")},iD.Util={},iD.Util._counters={},iD.Util.id=function(e){return e=e||"default",iD.Util._counters[e]||(iD.Util._counters[e]=0),e[0]+ --iD.Util._counters[e]},iD.Util.trueObj=function(e){var t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]=!0;return t},iD.Util.friendlyName=function(e){if(!e.tags||!Object.keys(e.tags).length)return"";var t=["highway","amenity","railway","waterway"],n=[];e.tags.name&&n.push(e.tags.name),e.tags.ref&&n.push(e.tags.ref);if(!n.length)for(var r in e.tags)if(t.indexOf(r)!==-1){n.push(e.tags[r]);break}return n.length===0?"unknown":n.join("; ")},iD.Util.codeWindow=function(e){top.win=window.open("","contentWindow","width=350,height=350,menubar=0,toolbar=1,status=0,scrollbars=1,resizable=1"),top.win.document.writeln("<pre>"+e+"</pre>"),top.win.document.close()},iD.Util.tagText=function(e){return d3.entries(e.tags).map(function(e){return e.key+": "+e.value}).join("\n")},iD.actions={},iD.actions.noop=function(){return function(e){return e}},iD.actions.addNode=function(e){return function(t){return t.replace(e,"added a place")}},iD.actions.startWay=function(e){return function(t){return t.replace(e,"started a road")}},iD.actions.remove=function(e){return function(t){return t.remove(e,"removed a feature")}},iD.actions.addWayNode=function(e,t){return function(n){return n.replace(e.update({nodes:e.nodes.slice()})).replace(t,"added to a road")}},iD.actions.removeWayNode=function(e,t){return function(n){return n.replace(e.update({nodes:e.nodes.slice()})).remove(t,"removed from a road")}},iD.actions.changeWayDirection=function(e){return function(t){return t.replace(e.update({nodes:e.nodes.slice()}),"changed way direction")}},iD.actions.changeTags=function(e,t){return function(n){return n.replace(e.update({tags:t}),"changed tags")}},iD.actions.move=function(e,t){return function(n){return n.replace(e.update({lon:t.lon||t[0],lat:t.lat||t[1]}),"moved an element")}},iD.actions.addTemporary=function(e){return function(t){return t.replace(e)}},iD.actions.removeTemporary=function(e){return function(t){return t.remove(e)}},iD.modes={},iD.modes._node=function(e){return iD.Node({lat:e[1],lon:e[0],tags:{}})},iD.modes.AddPlace={title:"+ Place",enter:function(){var e=this.map.surface,t=e.selectAll("g#temp-g").append("g").attr("id","addplace");t.append("circle").attr({"class":"handle",r:3}),e.on("mousemove.addplace",function(){t.attr("transform",function(){var t=d3.mouse(e.node());return"translate("+t+")"})}),e.on("click.addplace",function(){var t=this.map.projection.invert(d3.mouse(e.node())),n=iD.modes._node(t);n._poi=!0,this.map.perform(iD.actions.addNode(n)),this.map.selectEntity(n),this.exit()}.bind(this)),d3.select(document).on("keydown.addplace",function(){d3.event.keyCode===27&&this.exit()}.bind(this))},exit:function(){this.map.surface.on("mousemove.addplace",null).on("click.addplace",null),d3.select(document).on("keydown.addplace",null),d3.selectAll("#addplace").remove()}},iD.modes.dist=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},iD.modes.chooseIndex=function(e,t,n){var r=iD.modes.dist,i=e.nodes.map(function(e){return n.projection([e.lon,e.lat])});for(var s=0,o=[];s<i.length-1;s++)o[s]=(r(i[s],t)+r(t,i[s+1]))/r(i[s],i[s+1]);return _.indexOf(o,_.min(o))+1},iD.modes.AddRoad={title:"+ Road",way:function(){return iD.Way({tags:{highway:"residential",elastic:"true"}})},enter:function(){function e(){var e=d3.select(d3.event.target),n,r="forward",i=!0,s=this.way();if(e.data()&&e.data()[0]&&e.data()[0].type==="node"){var o=e.data()[0].id,u=this.map.history.graph().parents(o);u.length&&u[0].nodes[0]===o?(s=u[0],r="backward",i=!1):u.length&&_.last(u[0].nodes)===o&&(s=u[0],i=!1),n=e.data()[0]}else if(e.data()&&e.data()[0]&&e.data()[0].type==="way"){var a=iD.modes.chooseIndex(e.data()[0],d3.mouse(t.node()),this.map);n=iD.modes._node(this.map.projection.invert(d3.mouse(t.node())));var f=this.map.history.graph().entity(e.data()[0].id);f.nodes.splice(a,0,n.id),this.map.perform(iD.actions.addWayNode(f,n))}else n=iD.modes._node(this.map.projection.invert(d3.mouse(t.node())));i&&(this.map.perform(iD.actions.startWay(s)),s.nodes.push(n.id),this.map.perform(iD.actions.addWayNode(s,n))),this.controller.enter(iD.modes.DrawRoad(s.id,r))}this.map.dblclickEnable(!1);var t=this.map.surface,n=t.selectAll("g#temp-g").append("g").attr("id","addroad");n.append("circle").attr({"class":"handle",r:3}).style("pointer-events","none"),t.on("mousemove.addroad",function(){n.attr("transform",function(){var e=d3.mouse(t.node());return"translate("+e+")"})}),t.on("click.addroad",e.bind(this)),d3.select(document).on("keydown.addroad",function(){d3.event.keyCode===27&&this.exit()}.bind(this))},exit:function(){this.map.dblclickEnable(!0),this.map.surface.on("click.addroad",null).on("mousemove.addroad",null),d3.select(document).on("keydown.addroad",null),d3.selectAll("#addroad").remove()}},iD.modes.DrawRoad=function(e,t){return{enter:function(){function n(){var n=d3.select(d3.event.target);d3.event.stopPropagation();if(n.data()&&n.data()[0]&&n.data()[0].type==="node"){if(n.data()[0].id==f||n.data()[0].id==l){var o=this.map.history.graph().entity(a.nodes[i]());return this.map.perform(iD.actions.removeWayNode
(a,o)),t==="forward"&&n.data()[0].id==f?(a.nodes[r](f),this.map.perform(iD.actions.addWayNode(a,this.map.history.graph().entity(f)))):t==="backward"&&n.data()[0].id==l&&(a.nodes[r](l),this.map.perform(iD.actions.addWayNode(a,this.map.history.graph().entity(l)))),delete a.tags.elastic,this.map.perform(iD.actions.changeTags(a,a.tags)),this.map.selectEntity(a),this.exit()}node=n.data()[0]}else if(n.data()&&n.data()[0]&&n.data()[0].type==="way"){var u=iD.modes.chooseIndex(n.data()[0],d3.mouse(s.node()),this.map);node=iD.modes._node(this.map.projection.invert(d3.mouse(s.node())));var c=this.map.history.graph().entity(n.data()[0].id);c.nodes.splice(1,0,node.id),this.map.perform(iD.actions.addWayNode(c,node))}else node=iD.modes._node(this.map.projection.invert(d3.mouse(s.node())));var h=this.map.history.graph().entity(a.nodes[i]());this.map.perform(iD.actions.removeWayNode(a,h)),a.nodes[r](node.id),this.map.perform(iD.actions.addWayNode(a,node)),a.nodes=a.nodes.slice(),this.controller.enter(iD.modes.DrawRoad(e,t))}var r=t==="forward"?"push":"unshift",i=t==="forward"?"pop":"shift";this.map.dblclickEnable(!1);var s=this.map.surface,o=iD.modes._node([NaN,NaN]),u=o.id,a=this.map.history.graph().entity(e),f=a.nodes[0],l=_.last(a.nodes);a.nodes[r](u),this.map.perform(iD.actions.addWayNode(a,o)),s.on("mousemove.drawroad",function(){var t=this.map.projection.invert(d3.mouse(s.node())),n=this.map.history.graph().entity(e),r=iD.Entity(this.map.history.graph().entity(u),{lon:t[0],lat:t[1]});this.map.history.replace(iD.actions.addWayNode(n,r));var i=iD.Util.trueObj([n.id].concat(_.pluck(n.nodes,"id")));this.map.redraw(i)}.bind(this)),s.on("click.drawroad",n.bind(this))},exit:function(){this.map.surface.on("mousemove.drawroad",null).on("click.drawroad",null),d3.select(document).on(".drawroad",null),d3.selectAll("#drawroad").remove(),window.setTimeout(function(){this.map.dblclickEnable(!0)}.bind(this),1e3)}}},iD.modes.AddArea={title:"+ Area",way:function(){return iD.Way({tags:{building:"yes",area:"yes",elastic:"true"}})},enter:function(){function e(){var e=d3.select(d3.event.target),n,r=this.way();e.data()&&e.data()[0]&&e.data()[0].type==="node"?n=e.data()[0]:n=iD.modes._node(this.map.projection.invert(d3.mouse(t.node()))),this.map.perform(iD.actions.startWay(r)),r.nodes.push(n.id),this.map.perform(iD.actions.addWayNode(r,n)),this.map.selectEntity(r),this.controller.enter(iD.modes.DrawArea(r.id))}this.map.dblclickEnable(!1);var t=this.map.surface,n=t.selectAll("g#temp-g").append("g").attr("id","addarea");n.append("circle").attr({"class":"handle",r:3}).style("pointer-events","none"),t.on("mousemove.addarea",function(){n.attr("transform",function(){var e=d3.mouse(t.node());return"translate("+e+")"})}),t.on("click.addarea",e.bind(this)),d3.select(document).on("keydown.addarea",function(){d3.event.keyCode===27&&this.exit()}.bind(this))},exit:function(){window.setTimeout(function(){this.map.dblclickEnable(!0)}.bind(this),1e3),this.map.surface.on("click.addarea",null).on("mousemove.addarea",null),d3.select(document).on("keydown.addarea",null),d3.selectAll("#addarea").remove()}},iD.modes.DrawArea=function(e){return{enter:function(){function t(){var t=d3.select(d3.event.target);d3.event.stopPropagation();if(t.data()&&t.data()[0]&&t.data()[0].type==="node"){if(t.data()[0].id==o){var r=this.map.history.graph().entity(s.nodes.pop());return this.map.perform(iD.actions.removeWayNode(s,r)),s.nodes.push(s.nodes[0]),this.map.perform(iD.actions.addWayNode(s,this.map.history.graph().entity(s.nodes[0]))),delete s.tags.elastic,this.map.perform(iD.actions.changeTags(s,s.tags)),this.exit()}node=t.data()[0]}else node=iD.modes._node(this.map.projection.invert(d3.mouse(n.node())));var i=this.map.history.graph().entity(s.nodes.pop());this.map.perform(iD.actions.removeWayNode(s,i)),s.nodes.push(node.id),this.map.perform(iD.actions.addWayNode(s,node)),s.nodes=s.nodes.slice(),this.controller.enter(iD.modes.DrawArea(e))}this.map.dblclickEnable(!1);var n=this.map.surface,r=iD.modes._node([NaN,NaN]),i=r.id,s=this.map.history.graph().entity(e),o=_.first(s.nodes);s.nodes.push(i),this.map.perform(iD.actions.addWayNode(s,r)),n.on("mousemove.drawarea",function(){var t=this.map.projection.invert(d3.mouse(n.node())),r=this.map.history.graph().entity(e),s=iD.Entity(this.map.history.graph().entity(i),{lon:t[0],lat:t[1]});this.map.history.replace(iD.actions.addWayNode(r,s));var o=iD.Util.trueObj([r.id].concat(_.pluck(r.nodes,"id")));this.map.redraw(o)}.bind(this)),n.on("click.drawarea",t.bind(this))},exit:function(){this.map.surface.on("mousemove.drawarea",null),this.map.surface.on("click.drawarea",null),this.map.surface.on("dblclick.drawarea",null),d3.select(document).on(".drawarea",null),d3.selectAll("#drawarea").remove(),window.setTimeout(function(){this.map.dblclickEnable(!0)}.bind(this),1e3)}}},iD.modes.Move={enter:function(){},exit:function(){}},iD.Entity=function(e,t){if(!(this instanceof iD.Entity))return new iD.Entity(e,t);_.extend(this,{tags:{}},e,t),t&&(this._updated=!0),this.id||(this.id=iD.Util.id(this.type),this._updated=!0),iD.debug&&(Object.freeze(this),Object.freeze(this.tags))},iD.Entity.prototype={update:function(e){return e._updated=!0,iD.Entity(this,e)},created:function(){return this._updated&&+this.id.slice(1)<0},modified:function(){return this._updated&&+this.id.slice(1)>0}},iD.Node=function(e){return iD.Entity(_.extend({},e||{},{type:"node"}))},iD.Way=function(e){return iD.Entity(_.extend({},e||{},{type:"way",nodes:[]}))},iD.Relation=function(e){return iD.Entity(_.extend({},e||{},{type:"relation"}))},iD.Graph=function(e,t){if(!(this instanceof iD.Graph))return new iD.Graph(e,t);this.entities=e||{},this.annotation=t,iD.debug&&(Object.freeze(this),Object.freeze(this.entities))},iD.Graph.prototype={entity:function(e){return this.entities[e]},parents:function(e){return _.filter(this.entities,function(t){return t.type!=="way"?!1:t.nodes.indexOf(e)!==-1})},merge:function(e){var t=_.clone(this.entities);return _.defaults(t,e.entities),iD.Graph(t,this.annotation)},replace:function(e,t){var n=_.clone(this.entities);return n[e.id]=e,iD.Graph(n,t)},remove:function(e,t){var n=_.clone(this.entities);return delete n[e.id],iD.Graph(n,t)},nodeIntersect:function(e,t){return e.lon>t[0][0]&&e.lon<t[1][0]&&e.lat<t[0][1]&&e.lat>t[1][1]},wayIntersect:function(e,t){return e._extent[0][0]>t[0][0]&&e._extent[1][0]<t[1][0]&&e._extent[0][1]<t[0][1]&&e._extent[1][1]>t[1][1]},indexWay:function(e){if(e.type==="way"&&!e._extent){var t=[[-Infinity,Infinity],[Infinity,-Infinity]],n=e;for(var r=0,i=n.nodes.length;r<i;r++)n.nodes[r].lon>t[0][0]&&(t[0][0]=n.nodes[r].lon),n.nodes[r].lon<t[1][0]&&(t[1][0]=n.nodes[r].lon),n.nodes[r].lat<t[0][1]&&(t[0][1]=n.nodes[r].lat),n.nodes[r].lat>t[1][1]&&(t[1][1]=n.nodes[r].lat);e._extent=t}return!0},intersects:function(e){var t=[];for(var n in this.entities){var r=this.entities[n];if(r.type==="node"&&this.nodeIntersect(r,e))t.push(r);else if(r.type==="way"){var i=this.fetch(r.id);this.indexWay(i)&&this.wayIntersect(i,e)&&t.push(i)}}return t},fetch:function(e){var t=iD.Entity(this.entities[e]),n=[];if(!t.nodes||!t.nodes.length)return t;for(var r=0,i=t.nodes.length;r<i;r++)n[r]=this.fetch(t.nodes[r]);return t.nodes=n,t},modifications:function(){return _.filter(this.entities,function(e){return e.modified()}).map(function(e){return this.fetch(e.id)}.bind(this))},creations:function(){return _.filter(this.entities,function(e){return e.created()}).map(function(e){return this.fetch(e.id)}.bind(this))}},iD.History=function(){if(!(this instanceof iD.History))return new iD.History;this.stack=[iD.Graph()],this.index=0},iD.History.prototype={graph:function(){return this.stack[this.index]},merge:function(e){for(var t=0;t<this.stack.length;t++)this.stack[t]=this.stack[t].merge(e)},perform:function(e){this.stack=this.stack.slice(0,this.index+1),this.stack.push(e(this.graph())),this.index++},replace:function(e){this.stack[this.index]=e(this.graph())},undo:function(){while(this.index>0){this.index--;if(this.stack[this.index].annotation)break}},redo:function(){while(this.index<this.stack.length-1){this.index++;if(this.stack[this.index].annotation)break}},undoAnnotation:function(){var e=this.index;while(e>=0){if(this.stack[e].annotation)return this.stack[e].annotation;e--}},redoAnnotation:function(){var e=this.index+1;while(e<=this.stack.length-1){if(this.stack[e].annotation)return this.stack[e].annotation;e++}},modify:function(){return this.stack[this.index].modifications()},create:function(){return this.stack[this.index].creations()},"delete":function(){return _.difference(_.pluck(this.stack[0].entities,"id"),_.pluck(this.stack[this.index].entities,"id")).map(function(e){return this.stack[0].fetch(e)}.bind(this))},changes:function(){return{modify:this.modify(),create:this.create(),"delete":this["delete"]()}}},iD.Way.isClosed=function(e){return!e.nodes.length||e.nodes[e.nodes.length-1].id===e.nodes[0].id},iD.Background=function(){function e(e){var t="";for(var r=e[2];r>0;r--){var i=0,s=1<<r-1;(e[0]&s)!==0&&i++,(e[1]&s)!==0&&(i+=2),t+=i.toString()}var o=e[2]%5;return n.replace("{t}",o).replace("{u}",t).replace("{x}",e[0]).replace("{y}",e[1]).replace("{z}",e[2])}function t(){var t=r.scale(i.scale()).translate(i.translate())(),s=this.attr("transform",function(){return"scale("+t.scale+")translate("+t.translate+")"}).selectAll("image").data(t,function(e){return[e.join(),n].join()});s.exit().remove(),s.enter().append("image").attr("xlink:href",e).attr("width",1).attr("height",1).attr("x",function(e){return e[0]}).attr("y",function(e){return e[1]})}var n="http://ecn.t{t}.tiles.virtualearth.net/tiles/a{u}.jpeg?g=587&mkt=en-gb&n=z",r=d3.geo.tile(),i;return t.projection=function(e){return arguments.length?(i=e,t):i},t.size=function(e){return arguments.length?(r.size(e),t):r.size()},t.template=function(e){return arguments.length?(n=e,t):n},t},iD.Hash=function(){function e(e){return e.split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=null===n[1]?"":decodeURIComponent(n[1]),e},{})}function t(){if(location.hash===r)return;u(o,(r=location.hash).substring(1))&&f()}var n={},r,i=90-1e-8,s,o,u=function(t,n){var r=e(n),s=(r.map||"").split("/").map(Number);if(s.length<3||s.some(isNaN))return!0;t.setZoom(s[0]).center([s[2],Math.min(i,Math.max(-i,s[1]))])},a=function(e){var t=e.center(),n=e.getZoom(),r=Math.max(0,Math.ceil(Math.log(n)/Math.LN2));return"#?map="+n.toFixed(2)+"/"+t[1].toFixed(r)+"/"+t[0].toFixed(r)},f=_.throttle(function(){var e=a(o);r!==e&&location.replace(r=e)},1e3);return n.map=function(e){return arguments.length?(o&&(o.off("move",f),window.removeEventListener("hashchange",t,!1)),o=e,e&&(o.on("move",f),window.addEventListener("hashchange",t,!1),location.hash&&(t(),s=!0)),n):o},n.hadHash=s,n},iD.Map=function(e,t){function n(e){var t=-1,n=e.length,r=document.body.style;while(++t<n)if(e[t]+"Transform"in r)return"-"+e[t].toLowerCase()+"-";return""}function r(e){return[e.lon,e.lat]}function i(e){return{lon:e[0],lat:e[1]}}function s(e){return[Math.floor(e[0]),Math.floor(e[1])]}function o(){d3.select(".inspector-wrap").style("display","none")}function u(e){return e.id===Y}function a(e,t){return e.lon>t[0][0]&&e.lon<t[1][0]&&e.lat<t[0][1]&&e.lat>t[1][1]}function f(e){return iD.Way.isClosed(e)||e.tags.area&&e.tags.area==="yes"}function l(e){if(lt.style(St)!="none")return;var t=q(),n=[],r=[],i=[],s=[],o=[],u=j(),l=$.history.graph();if(!e)n=l.intersects(u);else for(var v in e)n.push(l.fetch(v));var y=e?function(t){return e[t.id]}:function(){return!0};if(n.length>2e3)return h();for(var b=0;b<n.length;b++){var w=n[b];w.type==="way"?(w._line=ot(w),f(w)?i.push(w):r.push(w)):w._poi?s.push(w):!w._poi&&w.type==="node"&&a(w,u)&&o.push(w)}c(o,y),g(r,y),p(i,y),m(r,y),d(s,y)}function c(e,t){var n=vt.hit.selectAll("image.handle").filter(t).data(e,at);n.exit().remove(),n.enter().append("image").attr({width:6,height:6,"class":"handle","xlink:href":"css/handle.png"}).call(st),n.attr("transform",function(e){var t=tt(r(e));return"translate("+[~~t[0],~~t[1]]+") translate(-3, -3) rotate(45, 3, 3)"}).classed("active",u)}function h(){lt.selectAll(".layer-g *").remove()}function p(e,t){var n=vt.fill.selectAll("path").filter(t).data(e,at);n.exit().remove(),n.enter().append("path").attr("class",yt).classed("active",u),n.attr("d",ut).attr("class",yt).classed("active",u)}function d(e,t){var n=vt.hit.selectAll("g.marker").filter(t).data(e,at);n.exit().remove();var r=n.enter().append("g").attr("class","marker").call(st);r.append("circle").attr({r:10,cx:8,cy:8}),r.append("image").attr({width:16,height:16}),n.attr("transform",function(e){var t=tt([e.lon,e.lat]);return"translate("+[~~t[0],~~t[1]]+") translate(-8, -8)"}).classed("active",u),n.select("image").attr("xlink:href",iD.Style.markerimage)}function v(e){return e.tags.oneway&&e.tags.oneway==="yes"}function m(e,t){var n=vt.stroke.selectAll("path").filter(t).data(e,at);n.exit().remove(),n.enter().append("path").attr("class",mt).classed("active",u),n.order().attr("d",ut).attr("class",mt).classed("active",u);var r={},i=n.filter(v).each(function(e){r[e.id]=Math.floor(this.getTotalLength()/wt)}).data(),s=ct.selectAll("path").data(i,at);s.exit().remove(),s.enter().append("path"),s.attr("id",function(e){return"shadow-"+e.id}).attr("d",ut);var o=vt.text.selectAll("text").data(i,at);o.exit().remove();var a=o.enter().append("text").attr({"class":"oneway",dy:4}).append("textPath").attr("class","textpath");vt.text.selectAll(".textpath").attr("letter-spacing",wt*2).attr("xlink:href",function(e,t){return"#shadow-"+e.id}).text(function(e){return(new Array(Math.floor(r[e.id]/2))).join("►")})}function g(e,t){var n=vt.casing.selectAll("path").filter(t).data(e,at);n.exit().remove(),n.enter().append("path").attr("class",bt).classed("active",u),n.order().attr("d",ut).attr("class",bt).classed("active",u)}function y(e){return J=e,lt.size(J).selectAll("#clip-rect").size(J),pt.size(J),M(),$}function b(e,t){var n=Math.pow(2,t);return[Math.floor(e[0]*n),Math.floor(e[1]*n),e[2]+t]}function w(e){if(et[e])return!1;for(var t=0;t<4;t++)if(et[b(e,-t)])return!1;return!0}function E(){function e(e){var t=e[0]*s-o[0],n=e[1]*s-o[1];return et[e]=!0,[tt.invert([t,n]),tt.invert([t+s,n+s])]}var t=tt.translate(),n=tt.scale(),r=Math.max(Math.log(n)/Math.log(2)-8,0),i=Math.floor(r),s=512*Math.pow(2,r-i),o=[n/2-t[0],n/2-t[1]],u=[],a=d3.range(Math.max(0,Math.floor(o[0]/s)),Math.max(0,Math.ceil((o[0]+J[0])/s))),f=d3.range(Math.max(0,Math.floor(o[1]/s)),Math.max(0,Math.ceil((o[1]+J[1])/s)));return a.forEach(function(e){f.forEach(function(t){u.push([e,t,i])})}),u.filter(w).map(e)}function S(e){t.bboxFromAPI(e,function(e){e instanceof Error||($.history.merge(e),l(iD.Util.trueObj(Object.keys(e.entities))))})}function x(){var e=d3.select(d3.event.target).data();e&&d3.select(".messages").text(e[0].tags.name||"#"+e[0].id)}function T(e){d3.select(".messages").text("")}function N(){var e=!!Y;Y=null,e&&(M(),o())}function C(e){Y=e.id,d3.select(".inspector-wrap").style("display","block").datum($.history.graph().fetch(e.id)).call(Q),M()}function k(){var e=d3.select(d3.event.target).data();e&&(e=e[0]);if(!e||Y===e.id||e.tags&&e.tags.elastic)return;Y=e.id,d3.select(".inspector-wrap").style("display","block").datum($.history.graph().fetch(e.id)).call(Q),M()}function L(e){$.history.graph().parents(e.id).filter(function(e){return e.type==="way"}).forEach(function(t){t.nodes=_.without(t.nodes,e.id),$.perform(iD.actions.removeWayNode(t,e))}),$.perform(iD.actions.remove(e))}function A(){if(d3.event&&d3.event.sourceEvent.type==="dblclick"&&!it)return;var e=d3.event.scale===tt.scale();tt.translate(d3.event.translate).scale(d3.event.scale);if(e){Z||(Z=d3.event.translate.slice());var t=d3.event.translate,n=Z;lt.style(St,"translate3d("+~~(t[0]-n[0])+"px,"+~~(t[1]-n[1])+"px, 0px)")}else M(),Z=null}function O(){if(!lt.style(St))return;Z=null,lt.style(St,""),M()}function M(e){e||(K.move($),ht.call(pt)),q()>16?(xt(),l(e)):h()}function D(e){$.history.perform(e),M()}function P(){$.history.undo(),M()}function H(){$.history.redo(),M()}function B(e){return arguments.length?(it=e,$):it}function j(){return[tt.invert([0,0]),tt.invert(J)]}function F(e){var t=tt.translate(),n=tt.scale();return[(e[0]-t[0])/n,(e[1]-t[1])/n]}function I(e){var t=tt.translate(),n=tt.scale();return[e[0]*n+t[0],e[1]*n+t[1]]}function q(e){return Math.max(Math.log(tt.scale())/Math.log(2)-7,0)}function R(){return[J[0]/2,J[0]/2]}function U(e){var t=256*Math.pow(2,e-1),n=R(),r=F(n);tt.scale(t),nt.scale(tt.scale());var i=tt.translate();return r=I(r),i[0]+=n[0]-r[0],i[1]+=n[1]-r[1],tt.translate(i),nt.translate(tt.translate()),M(),$}function z(){return U(Math.ceil(q()+1))}function W(){return U(Math.floor(q()-1))}function X(e){if(!arguments.length)return tt.invert(R());var t=tt.translate(),n=R(),r=tt(e);return tt.translate([t[0]-r[0]+n[0],t[1]-r[1]+n[1]]),nt.translate(tt.translate()),M(),$}function V(){et={}}var $={history:iD.History()},J=[],K=d3.dispatch("move","update"),Q=iD.Inspector(),G=d3.select(e),Y=null,Z,et={},tt=d3.geo.mercator(),nt=d3.behavior.zoom().translate(tt.translate()).scale(tt.scale()).scaleExtent([256,256*Math.pow(2,20)]).on("zoom",A),rt,it=!0,st=d3.behavior.drag().origin(function(e){var t=tt(r(e));return rt=iD.Util.trueObj([e.id].concat(_.pluck($.history.graph().parents(e.id),"id"))),{x:t[0],y:t[1]}}).on("dragstart",function(){$.history.perform(iD.actions.noop()),d3.event.sourceEvent.stopPropagation()}).on("drag",function(e){var t=tt.invert([d3.event.x,d3.event.y]);d3.event.sourceEvent.stopPropagation(),$.history.replace(iD.actions.move(e,t)),M(rt)}).on("dragend",M),ot=function(e){return"M"+e.nodes.map(r).map(tt).map(s).join("L")},ut=function(e){return e._line},at=function(e){return e.id},ft=G.append("div").call(nt),lt=ft.append("svg"),ct=lt.append("defs"),ht=lt.append("g").on("click",N),pt=iD.Background().projection(tt),dt=lt.append("g").on("click",k).on("mouseover",x).on("mouseout",T).attr("clip-path","url(#clip)"),vt=["fill","casing","stroke","text","hit","temp"].reduce(function(e,t){return(e[t]=dt.append("g").attr("class","layer-g"))&&e},{}),mt=iD.Style.styleClasses("stroke"),gt=iD.Style.styleClasses("stroke"),yt=iD.Style.styleClasses("area"),bt=iD.Style.styleClasses("casing"),wt=function(){var e=lt.append("text").text("►"),t=e.node().getComputedTextLength();return e.remove(),t}(),Et=n(["webkit","ms","Moz","O"]),St=Et+"transform";ct.append("clipPath").attr("id","clip").append("rect").attr("id","clip-rect").attr({x:0,y:0});var xt=_.debounce(function(){E().map(S)},1e3);return Q.on("changeTags",function(e,t){var n=$.history.graph().entity(e.id);$.perform(iD.actions.changeTags(n,t))}).on("changeWayDirection",function(e){$.perform(iD.actions.changeWayDirection(e))}).on("remove",function(e){L(e),o()}).on("close",function(){N(),o()}),lt.on("mouseup",O).on("touchend",O),$.download=xt,$.getExtent=j,$.selectEntity=C,$.background=pt,$.center=X,$.centre=X,$.getZoom=q,$.setZoom=U,$.zoomIn=z,$.zoomOut=W,$.projection=tt,$.size=y,$.surface=lt,$.perform=D,$.undo=P,$.redo=H,$.redraw=M,$.flush=V,$.dblclickEnable=B,y(G.size()),o(),M(),d3.rebind($,K,"on","move","update")},iD._markers=[{tags:{aeroway:"helipad"},icon:"helipad"},{tags:{aeroway:"airport"},icon:"airport"},{tags:{aeroway:"aerodrome"},icon:"aerodrome"},{tags:{railway:"level_crossing"},icon:"level_crossing"},{tags:{man_made:"lighthouse"},icon:"lighthouselevel_crossing"},{tags:{natural:"peak"},icon:"peak"},{tags:{natural:"volcano"},icon:"volcano"},{tags:{natural:"cave_entrance"},icon:"poi_cave"},{tags:{natural:"spring"},icon:"spring"},{tags:{natural:"tree"},icon:"tree"},{tags:{power:"generator","generator:source":"wind"},icon:"power_wind"},{tags:{power:"generator",power_source:"wind"},icon:"power_wind"},{tags:{man_made:"power_wind"},icon:"power_wind"},{tags:{man_made:"windmill"},icon:"windmill"},{tags:{man_made:"mast"},icon:"communications"},{tags:{highway:"mini_roundabout"},icon:"mini_roundabout"},{tags:{highway:"gate"},icon:"gate2"},{tags:{barrier:"gate"},icon:"gate2"},{tags:{barrier:"lift_gate"},icon:"liftgate"},{tags:{barrier:"bollard"},icon:"bollard"},{tags:{barrier:"block"},icon:"bollard"},{icon:"alpinehut",tags:{tourism:"alpine_hut"}},{icon:"shelter2",tags:{amenity:"shelter"}},{icon:"atm2",tags:{amenity:"atm"}},{icon:"bank2",tags:{amenity:"bank"}},{icon:"bar",tags:{amenity:"bar"}},{icon:"rental_bicycle",tags:{amenity:"bicycle_rental"}},{icon:"bus_stop_small",tags:{amenity:"bus_stop"}},{icon:"bus_stop",tags:{amenity:"bus_stop"}},{icon:"bus_station",tags:{amenity:"bus_station"}},{icon:"traffic_light",tags:{highway:"traffic_signals"}},{icon:"cafe",tags:{amenity:"cafe"}},{icon:"camping",tags:{tourism:"camp_site"}},{icon:"transport_ford",tags:{highway:"ford"}},{icon:"caravan_park",tags:{tourism:"caravan_site"}},{icon:"car_share",tags:{amenity:"car_sharing"}},{icon:"chalet",tags:{tourism:"chalet"}},{icon:"cinema",tags:{amenity:"cinema"}},{icon:"firestation",tags:{amenity:"fire_station"}},{icon:"fuel",tags:{amenity:"fuel"}},{icon:"guest_house",tags:{tourism:"guest_house"}},{icon:"bandb",tags:{tourism:"bed_and_breakfast"}},{icon:"hospital",tags:{amenity:"hospital"}},{icon:"hostel",tags:{tourism:"hostel"}},{icon:"hotel2",tags:{tourism:"hotel"}},{icon:"motel",tags:{tourism:"motel"}},{icon:"information",tags:{tourism:"information"}},{icon:"embassy",tags:{amenity:"embassy"}},{icon:"library",tags:{amenity:"library"}},{icon:"amenity_court",tags:{amenity:"courthouse"}},{icon:"lock_gate",tags:{waterway:"lock"}},{icon:"communications",tags:{man_made:"mast"}},{icon:"museum",tags:{tourism:"museum"}},{icon:"parking",tags:{amenity:"parking"}},{icon:"parking_private",tags:{amenity:"parking"}},{icon:"pharmacy",tags:{amenity:"pharmacy"}},{icon:"christian3",tags:{amenity:"place_of_worship"}},{icon:"islamic3",tags:{amenity:"place_of_worship"}},{icon:"sikh3",tags:{amenity:"place_of_worship"}},{icon:"jewish3",tags:{amenity:"place_of_worship"}},{icon:"place_of_worship3",tags:{amenity:"place_of_worship"}},{icon:"police",tags:{amenity:"police"}},{icon:"post_box",tags:{amenity:"post_box"}},{icon:"post_office",tags:{amenity:"post_office"}},{icon:"pub",tags:{amenity:"pub"}},{icon:"biergarten",tags:{amenity:"biergarten"}},{icon:"recycling",tags:{amenity:"recycling"}},{icon:"restaurant",tags:{amenity:"restaurant"}},{icon:"fast_food",tags:{amenity:"fast_food"}},{icon:"telephone",tags:{amenity:"telephone"}},{icon:"sosphone",tags:{amenity:"emergency_phone"}},{icon:"theatre",tags:{amenity:"theatre"}},{icon:"toilets",tags:{amenity:"toilets"}},{icon:"food_drinkingtap",tags:{amenity:"drinking_water"}},{icon:"amenity_prison",tags:{amenity:"prison"}},{icon:"view_point",tags:{tourism:"viewpoint"}},{icon:"tower_water",tags:{man_made:"water_tower"}},{icon:"tourist_memorial",tags:{historic:"memorial"}},{icon:"tourist_archaeological2",tags:{historic:"archaeological_site"}},{icon:"shop_supermarket",tags:{shop:"supermarket"}},{icon:"shop_bakery",tags:{shop:"bakery"}},{icon:"shop_butcher",tags:{shop:"butcher"}},{icon:"shop_clothes",tags:{shop:"clothes"}},{icon:"shop_convenience",tags:{shop:"convenience"}},{icon:"department_store",tags:{shop:"department_store"}},{icon:"shop_diy",tags:{shop:"doityourself"}},{icon:"florist",tags:{shop:"florist"}},{icon:"shop_hairdresser",tags:{shop:"hairdresser"}},{icon:"shopping_car",tags:{shop:"car"}},{icon:"shopping_car_repair",tags:{shop:"car_repair"}},{icon:"shopping_bicycle",tags:{shop:"bicycle"}},{icon:"playground",tags:{leisure:"playground"}},{icon:"picnic",tags:{amenity:"picnic_site"}},{icon:"transport_slipway",tags:{leisure:"slipway"}}],iD._markertable=function(e){var t={};for(var n=0;n<e.length;n++){var r=e[n];if(Object.keys(r.tags).length===1)for(var i in r.tags){var s=i+"="+r.tags[i];t[s]=r.icon}}return t}(iD._markers),iD.Style={},iD.Style.highway_stack={motorway:0,motorway_link:1,trunk:2,trunk_link:3,primary:4,primary_link:5,secondary:6,tertiary:7,unclassified:8,residential:9,service:10,footway:11},iD.Style.waystack=function(e,t){if(!e||!t)return 0;if(e.tags.layer!==undefined&&t.tags.layer!==undefined)return e.tags.layer-t.tags.layer;if(e.tags.bridge)return 1;if(t.tags.bridge)return-1;var n=0,r=0;return e.tags.highway&&t.tags.highway&&(n-=iD.Style.highway_stack[e.tags.highway],r-=iD.Style.highway_stack[t.tags.highway]),n-r},iD.Style.markerimage=function(e){for(var t in e.tags){var n=t+"="+e.tags[t];if(iD._markertable[n])return"icons/"+iD._markertable[n]+".png"}return"icons/unknown.png"},iD.Style.TAG_CLASSES=iD.Util.trueObj(["highway","railway","motorway","amenity","landuse","building","oneway","bridge","elastic"]),iD.Style.styleClasses=function(e){return function(t){var n=t.tags,r=[e];for(var i in n){if(!iD.Style.TAG_CLASSES[i])continue;r.push(i+"-"+n[i]),r.push(i)}return r.join(" ")}},iD.commit=function(){function e(e){var n=e.datum(),r=e.append("div").attr("class","header"),i=e.append("div").attr("class","body");r.append("h2").text("Upload Changes to OpenStreetMap"),r.append("p").text("the changes you upload will be visible on all maps using OpenStreetMap data");var s=i.selectAll("div.commit-section").data(["modify","delete","create"].filter(function(e){return n[e].length})).enter().append("div").attr("class","commit-section");s.append("h3").text(String).append("small").attr("class","count").text(function(e){return n[e].length});var o=s.append("ul").selectAll("li").data(function(e){return n[e]}).enter().append("li");o.append("strong").text(function(e){return e.type+" "}),o.append("span").text(function(e){return iD.Util.friendlyName(e)}).attr("title",iD.Util.tagText),i.append("textarea").attr("class","changeset-comment").attr("placeholder","Brief Description"),i.append("button").text("Save").attr("class","save").on("click",function(){t.save({comment:d3.select("textarea.changeset-comment").node().value})}),i.append("button").text("Cancel").attr("class","cancel").on("click",function(){t.cancel()})}var t=d3.dispatch("cancel","save");return d3.rebind(e,t,"on")},iD.Inspector=function(){function e(e){e.html(""),e.append("h2").text(iD.Util.friendlyName(e.datum())),e.append("a").attr("class","permalink").attr("href",function(e){return"http://www.openstreetmap.org/browse/"+e.type+"/"+e.id.slice(1)}).text("View on OSM"),e.append("a").attr({"class":"permalink",href:"#"}).text("XML").on("click",function(e){d3.event.stopPropagation(),iD.Util.codeWindow(iD.format.XML.mapping(e))}),e.append("a").attr({"class":"permalink",href:"#"}).text("GeoJSON").on("click",function(e){d3.event.stopPropagation(),iD.Util.codeWindow(JSON.stringify(iD.format.GeoJSON.mapping(e),null,2))}),e.datum().type==="way"&&e.append("a").attr("class","permalink").attr("href","#").text("Reverse Direction").on("click",function(e){n.changeWayDirection(iD.Entity(e,{nodes:_.pluck(e.nodes.reverse(),"id")}))})}function t(t){t.each(function(r){function i(e){tr=c.selectAll("tr").data(d3.entries(e)),tr.exit().remove(),row=tr.enter().append("tr"),valuetds=row.selectAll("td").data(function(e){return[e,e]}),valuetds.enter().append("td").append("input").property("value",function(e,t){return e[t?"value":"key"]}).on("keyup",function(e,t){e[t?"value":"key"]=this.value,a()}),row.append("td").attr("class","tag-help").append("a").text("?").attr("target","_blank").attr("tabindex",-1).attr("href",function(e){return"http://taginfo.openstreetmap.org/keys/"+e.key})}function s(e){for(var t in e)t||delete e[t];return e}function o(e){return e[""]||(e[""]=""),e}function u(){function e(e){t[e.key]=e.value}var t={};return c.selectAll("td").each(e),t}function a(){i(o(u()))}function f(e){e.append("button").attr("class","save").text("Save").on("click",function(e){n.changeTags(e,s(u())),n.close(e)}),e.append("button").attr("class","cancel").text("Cancel").on("click",function(e){n.close(e)}),e.append("button").attr("class","delete").text("Delete").on("click",function(e){n.remove(e)})}t.html("").append("button").text("x").attr({title:"close","class":"close"}).on("click",function(){n.close(r)}),t.append("div").attr("class","head").call(e);var l=t.append("div").attr("class","tag-table-wrap").append("table").attr("class","inspector");l.append("thead").append("tr").selectAll("th").data(["tag","value",""]).enter().append("th").text(String);var c=l.append("tbody"),h=_.clone(r.tags);i(h),a(),t.append("div").attr("class","buttons").call(f)})}var n=d3.dispatch("changeTags","changeWayDirection","update","remove","close");return d3.rebind(t,n,"on")},iD.loading=function(e){var t=d3.select("div.loading");t.empty()&&(t=d3.select(document.body).append("div").attr("class","loading shaded")),t.append("div").attr("class","modal loading-pane").text(e||"");var n={};return n.remove=function(){d3.select("div.loading").remove()},n},iD.userpanel=function(e){function t(t){function r(){t.html(""),e.authenticated()?e.userDetails(function(r){t.append("span").text("signed in as ").append("a").attr("href",e.url()+"/user/"+r.display_name).attr("target","_blank").text(r.display_name),t.append("a").attr("class","logout").attr("href","#").text("logout").on("click",function(){d3.event.preventDefault(),n.logout()})}):t.append("a").attr("class","login").attr("href","#").text("login").on("click",n.login)}e.on("auth",r),r()}var n=d3.dispatch("logout","login");return d3.rebind(t,n,"on")};